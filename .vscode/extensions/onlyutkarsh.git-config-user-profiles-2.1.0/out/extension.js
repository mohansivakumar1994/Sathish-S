"use strict";var No=Object.create;var st=Object.defineProperty;var Lo=Object.getOwnPropertyDescriptor;var Mo=Object.getOwnPropertyNames;var Do=Object.getPrototypeOf,$o=Object.prototype.hasOwnProperty;var re=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Bo=(e,t)=>{for(var r in t)st(e,r,{get:t[r],enumerable:!0})},Zr=(e,t,r,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Mo(t))!$o.call(e,n)&&n!==r&&st(e,n,{get:()=>t[n],enumerable:!(s=Lo(t,n))||s.enumerable});return e};var $=(e,t,r)=>(r=e!=null?No(Do(e)):{},Zr(t||!e||!e.__esModule?st(r,"default",{value:e,enumerable:!0}):r,e)),Uo=e=>Zr(st({},"__esModule",{value:!0}),e);var ws=re((bf,vs)=>{"use strict";var Ie=1e3,Re=Ie*60,Oe=Re*60,we=Oe*24,qo=we*7,zo=we*365.25;vs.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return Qo(e);if(r==="number"&&isFinite(e))return t.long?Ho(e):Yo(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Qo(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),s=(t[2]||"ms").toLowerCase();switch(s){case"years":case"year":case"yrs":case"yr":case"y":return r*zo;case"weeks":case"week":case"w":return r*qo;case"days":case"day":case"d":return r*we;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Oe;case"minutes":case"minute":case"mins":case"min":case"m":return r*Re;case"seconds":case"second":case"secs":case"sec":case"s":return r*Ie;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Yo(e){var t=Math.abs(e);return t>=we?Math.round(e/we)+"d":t>=Oe?Math.round(e/Oe)+"h":t>=Re?Math.round(e/Re)+"m":t>=Ie?Math.round(e/Ie)+"s":e+"ms"}function Ho(e){var t=Math.abs(e);return t>=we?mt(e,t,we,"day"):t>=Oe?mt(e,t,Oe,"hour"):t>=Re?mt(e,t,Re,"minute"):t>=Ie?mt(e,t,Ie,"second"):e+" ms"}function mt(e,t,r,s){var n=t>=r*1.5;return Math.round(e/r)+" "+s+(n?"s":"")}});var tr=re((_f,ys)=>{"use strict";function Jo(e){r.debug=r,r.default=r,r.coerce=d,r.disable=i,r.enable=n,r.enabled=a,r.humanize=ws(),r.destroy=p,Object.keys(e).forEach(c=>{r[c]=e[c]}),r.names=[],r.skips=[],r.formatters={};function t(c){let f=0;for(let m=0;m<c.length;m++)f=(f<<5)-f+c.charCodeAt(m),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=t;function r(c){let f,m=null,g,C;function M(...S){if(!M.enabled)return;let W=M,le=Number(new Date),zt=le-(f||le);W.diff=zt,W.prev=f,W.curr=le,f=le,S[0]=r.coerce(S[0]),typeof S[0]!="string"&&S.unshift("%O");let Te=0;S[0]=S[0].replace(/%([a-zA-Z%])/g,(Ue,Qt)=>{if(Ue==="%%")return"%";Te++;let rt=r.formatters[Qt];if(typeof rt=="function"){let Yt=S[Te];Ue=rt.call(W,Yt),S.splice(Te,1),Te--}return Ue}),r.formatArgs.call(W,S),(W.log||r.log).apply(W,S)}return M.namespace=c,M.useColors=r.useColors(),M.color=r.selectColor(c),M.extend=s,M.destroy=r.destroy,Object.defineProperty(M,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(g!==r.namespaces&&(g=r.namespaces,C=r.enabled(c)),C),set:S=>{m=S}}),typeof r.init=="function"&&r.init(M),M}function s(c,f){let m=r(this.namespace+(typeof f>"u"?":":f)+c);return m.log=this.log,m}function n(c){r.save(c),r.namespaces=c,r.names=[],r.skips=[];let f,m=(typeof c=="string"?c:"").split(/[\s,]+/),g=m.length;for(f=0;f<g;f++)m[f]&&(c=m[f].replace(/\*/g,".*?"),c[0]==="-"?r.skips.push(new RegExp("^"+c.slice(1)+"$")):r.names.push(new RegExp("^"+c+"$")))}function i(){let c=[...r.names.map(o),...r.skips.map(o).map(f=>"-"+f)].join(",");return r.enable(""),c}function a(c){if(c[c.length-1]==="*")return!0;let f,m;for(f=0,m=r.skips.length;f<m;f++)if(r.skips[f].test(c))return!1;for(f=0,m=r.names.length;f<m;f++)if(r.names[f].test(c))return!0;return!1}function o(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function d(c){return c instanceof Error?c.stack||c.message:c}function p(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}ys.exports=Jo});var bs=re((K,dt)=>{"use strict";K.formatArgs=Zo;K.save=ea;K.load=ta;K.useColors=Xo;K.storage=ra();K.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();K.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Xo(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Zo(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+dt.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,s=0;e[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(r++,n==="%c"&&(s=r))}),e.splice(s,0,t)}K.log=console.debug||console.log||(()=>{});function ea(e){try{e?K.storage.setItem("debug",e):K.storage.removeItem("debug")}catch{}}function ta(){let e;try{e=K.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function ra(){try{return localStorage}catch{}}dt.exports=tr()(K);var{formatters:sa}=dt.exports;sa.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var ks=re((kf,_s)=>{"use strict";_s.exports=(e,t)=>{t=t||process.argv;let r=e.startsWith("-")?"":e.length===1?"-":"--",s=t.indexOf(r+e),n=t.indexOf("--");return s!==-1&&(n===-1?!0:s<n)}});var Ts=re((Cf,Cs)=>{"use strict";var na=require("os"),Z=ks(),N=process.env,xe;Z("no-color")||Z("no-colors")||Z("color=false")?xe=!1:(Z("color")||Z("colors")||Z("color=true")||Z("color=always"))&&(xe=!0);"FORCE_COLOR"in N&&(xe=N.FORCE_COLOR.length===0||parseInt(N.FORCE_COLOR,10)!==0);function ia(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function oa(e){if(xe===!1)return 0;if(Z("color=16m")||Z("color=full")||Z("color=truecolor"))return 3;if(Z("color=256"))return 2;if(e&&!e.isTTY&&xe!==!0)return 0;let t=xe?1:0;if(process.platform==="win32"){let r=na.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(r[0])>=10&&Number(r[2])>=10586?Number(r[2])>=14931?3:2:1}if("CI"in N)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(r=>r in N)||N.CI_NAME==="codeship"?1:t;if("TEAMCITY_VERSION"in N)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(N.TEAMCITY_VERSION)?1:0;if(N.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in N){let r=parseInt((N.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(N.TERM_PROGRAM){case"iTerm.app":return r>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(N.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(N.TERM)||"COLORTERM"in N?1:(N.TERM==="dumb",t)}function rr(e){let t=oa(e);return ia(t)}Cs.exports={supportsColor:rr,stdout:rr(process.stdout),stderr:rr(process.stderr)}});var Ps=re((F,gt)=>{"use strict";var aa=require("tty"),pt=require("util");F.init=pa;F.log=fa;F.formatArgs=ca;F.save=ma;F.load=da;F.useColors=ua;F.destroy=pt.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");F.colors=[6,2,3,4,5,1];try{let e=Ts();e&&(e.stderr||e).level>=2&&(F.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}F.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{let r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(n,i)=>i.toUpperCase()),s=process.env[t];return/^(yes|on|true|enabled)$/i.test(s)?s=!0:/^(no|off|false|disabled)$/i.test(s)?s=!1:s==="null"?s=null:s=Number(s),e[r]=s,e},{});function ua(){return"colors"in F.inspectOpts?!!F.inspectOpts.colors:aa.isatty(process.stderr.fd)}function ca(e){let{namespace:t,useColors:r}=this;if(r){let s=this.color,n="\x1B[3"+(s<8?s:"8;5;"+s),i=`  ${n};1m${t} \x1B[0m`;e[0]=i+e[0].split(`
`).join(`
`+i),e.push(n+"m+"+gt.exports.humanize(this.diff)+"\x1B[0m")}else e[0]=la()+t+" "+e[0]}function la(){return F.inspectOpts.hideDate?"":new Date().toISOString()+" "}function fa(...e){return process.stderr.write(pt.format(...e)+`
`)}function ma(e){e?process.env.DEBUG=e:delete process.env.DEBUG}function da(){return process.env.DEBUG}function pa(e){e.inspectOpts={};let t=Object.keys(F.inspectOpts);for(let r=0;r<t.length;r++)e.inspectOpts[t[r]]=F.inspectOpts[t[r]]}gt.exports=tr()(F);var{formatters:Es}=gt.exports;Es.o=function(e){return this.inspectOpts.colors=this.useColors,pt.inspect(e,this.inspectOpts).split(`
`).map(t=>t.trim()).join(" ")};Es.O=function(e){return this.inspectOpts.colors=this.useColors,pt.inspect(e,this.inspectOpts)}});var nr=re((Tf,sr)=>{"use strict";typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?sr.exports=bs():sr.exports=Ps()});var Ss=re(q=>{"use strict";var ga=q&&q.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(q,"__esModule",{value:!0});var ha=require("fs"),va=ga(nr()),Ae=va.default("@kwsites/file-exists");function wa(e,t,r){Ae("checking %s",e);try{let s=ha.statSync(e);return s.isFile()&&t?(Ae("[OK] path represents a file"),!0):s.isDirectory()&&r?(Ae("[OK] path represents a directory"),!0):(Ae("[FAIL] path represents something other than a file or directory"),!1)}catch(s){if(s.code==="ENOENT")return Ae("[FAIL] path is not accessible: %o",s),!1;throw Ae("[FATAL] %o",s),s}}function ya(e,t=q.READABLE){return wa(e,(t&q.FILE)>0,(t&q.FOLDER)>0)}q.exists=ya;q.FILE=1;q.FOLDER=2;q.READABLE=q.FILE+q.FOLDER});var Is=re(ht=>{"use strict";function ba(e){for(var t in e)ht.hasOwnProperty(t)||(ht[t]=e[t])}Object.defineProperty(ht,"__esModule",{value:!0});ba(Ss())});var or=re(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.createDeferred=ye.deferred=void 0;function ir(){let e,t,r="pending";return{promise:new Promise((n,i)=>{e=n,t=i}),done(n){r==="pending"&&(r="resolved",e(n))},fail(n){r==="pending"&&(r="rejected",t(n))},get fulfilled(){return r!=="pending"},get status(){return r}}}ye.deferred=ir;ye.createDeferred=ir;ye.default=ir});var Fl={};Bo(Fl,{activate:()=>Il,deactivate:()=>Al});module.exports=Uo(Fl);var P=$(require("vscode"));var er=$(require("vscode"));var Zt=$(require("vscode"));var at=$(require("vscode")),ss=require("vscode");var b={CREATE_USER_PROFILE:"git-config-user-profiles.createUserProfile",GET_USER_PROFILE:"git-config-user-profiles.getUserProfile",PICK_USER_PROFILE:"git-config-user-profiles.pickUserProfile",EDIT_USER_PROFILE:"git-config-user-profiles.editUserProfile",DELETE_USER_PROFILE:"git-config-user-profiles.deleteUserProfile",SYNC_VSC_PROFILES_WITH_GIT_CONFIG:"git-config-user-profiles.syncVscProfilesWithGitConfig",STATUS_BAR_CLICK:"git-config-user-profiles.statusBarClick"},fe={APPLICATION_NAME:"Git Config User Profiles"},V={DOES_NOT_SUPPORT_MULTI_ROOT:"Sorry, the extension does not support multi root workspaces at the moment",OPEN_REPO_FIRST:"Sorry, you need to open a git repository first",NOT_A_VALID_REPO:"This does not seem to be a valid git repository",ENTER_A_VALID_STRING:"Please enter a valid string",NOT_A_VALID_EMAIL:"That does not seem to be a valid email. Please verify"};var me=require("vscode"),X=class e{constructor(){}static{this.back=new e}static{this.cancel=new e}static{this.resume=new e}},Ge=class e{constructor(){this.steps=[]}static async run(t){return new e().stepThrough(t)}async stepThrough(t){let r=t;for(;r;){this.steps.push(r),this.current&&(this.current.enabled=!1,this.current.busy=!0);try{r=await r(this)}catch(s){if(s===X.back)this.steps.pop(),r=this.steps.pop();else if(s===X.resume)r=this.steps.pop();else if(s===X.cancel)r=void 0;else throw s}}this.current&&this.current.dispose()}async showQuickPick({title:t,step:r,totalSteps:s,items:n,activeItem:i,placeholder:a,buttons:o,shouldResume:d}){let p=[];try{return await new Promise((c,f)=>{let m=me.window.createQuickPick();m.title=t,m.step=r,m.totalSteps=s,m.placeholder=a,m.items=n,i&&(m.activeItems=[i]),m.buttons=[...this.steps.length>1?[me.QuickInputButtons.Back]:[],...o||[]],p.push(m.onDidTriggerButton(g=>{g===me.QuickInputButtons.Back?f(X.back):c(g)}),m.onDidChangeSelection(g=>c(g[0])),m.onDidHide(()=>{(async()=>{f(d&&await d()?X.resume:X.cancel)})().catch(f)})),this.current&&this.current.dispose(),this.current=m,this.current.show()})}finally{p.forEach(c=>c.dispose())}}async showInputBox({title:t,step:r,totalSteps:s,value:n,prompt:i,placeholder:a,validate:o,buttons:d,shouldResume:p,ignoreFocusOut:c}){let f=[];try{return await new Promise((m,g)=>{let C=me.window.createInputBox();C.ignoreFocusOut=c,C.title=t,C.step=r,C.totalSteps=s,C.value=n||"",C.prompt=i,C.placeholder=a,C.buttons=[...this.steps.length>1?[me.QuickInputButtons.Back]:[],...d||[]];let M=o("");f.push(C.onDidTriggerButton(S=>{S===me.QuickInputButtons.Back?g(X.back):m(S)}),C.onDidAccept(async()=>{let S=C.value;C.enabled=!1,C.busy=!0,await o(S)||m(S),C.enabled=!0,C.busy=!1}),C.onDidChangeValue(async S=>{let W=o(S);M=W;let le=await W;W===M&&(C.validationMessage=le)}),C.onDidHide(()=>{(async()=>{g(p&&await p()?X.resume:X.cancel)})().catch(g)})),this.current&&this.current.dispose(),this.current=C,this.current.show()})}finally{f.forEach(m=>m.dispose())}}};var nt=require("path"),he=require("vscode");var ve=class e{static get instance(){return e._instance||(e._instance=new e),e._instance}constructor(){e._statusBar=he.window.createStatusBarItem(he.StatusBarAlignment.Right,1e6),_.instance.logInfo("Initializing status bar complete.")}async updateStatus(t,r,s="Normal",n){n=n||`${fe.APPLICATION_NAME} - Click status bar icon for more options`;let i=t,a=new he.ThemeColor("statusBarItem.activeBackground"),o=new he.ThemeColor("statusBarItem.warningBackground"),d=`$(source-control) ${fe.APPLICATION_NAME}`;i?r?s==="Normal"?(d=`$(source-control) ${(0,nt.basename)(r)} $(arrow-small-right) ${i.label.replace("$(check)","").trim()}`,n=`Profile: ${i.userName} (${i.email})\r
Click status bar icon for more options`):d=`$(source-control) ${(0,nt.basename)(r)} $(arrow-small-right) ${i.label.replace("$(alert)","").trim()}`:s==="Normal"?(d=`$(source-control) ${fe.APPLICATION_NAME} $(arrow-small-right) ${i.label.replace("$(check)","").trim()}`,n=`Profile: ${i.userName} (${i.email})\r
Click status bar icon for more options`):d=`$(source-control) ${fe.APPLICATION_NAME} $(arrow-small-right) ${i.label.replace("$(alert)","").trim()}`:r?d=`$(source-control) ${(0,nt.basename)(r)} $(arrow-small-right) $(question)`:d=`$(source-control) ${fe.APPLICATION_NAME} $(arrow-small-right) $(question)`,e._statusBar.text=d,e._statusBar.backgroundColor=s==="Normal"?a:o,e._statusBar.tooltip=n,e._statusBar.show()}attachCommand(t){e._statusBar.command=t}get StatusBar(){return e._statusBar}};var es=$(require("crypto")),ot=new Uint8Array(256),it=ot.length;function Jt(){return it>ot.length-16&&(es.default.randomFillSync(ot),it=0),ot.slice(it,it+=16)}var A=[];for(let e=0;e<256;++e)A.push((e+256).toString(16).slice(1));function ts(e,t=0){return A[e[t+0]]+A[e[t+1]]+A[e[t+2]]+A[e[t+3]]+"-"+A[e[t+4]]+A[e[t+5]]+"-"+A[e[t+6]]+A[e[t+7]]+"-"+A[e[t+8]]+A[e[t+9]]+"-"+A[e[t+10]]+A[e[t+11]]+A[e[t+12]]+A[e[t+13]]+A[e[t+14]]+A[e[t+15]]}var rs=$(require("crypto")),Xt={randomUUID:rs.default.randomUUID};function jo(e,t,r){if(Xt.randomUUID&&!t&&!e)return Xt.randomUUID();e=e||{};let s=e.random||(e.rng||Jt)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,t){r=r||0;for(let n=0;n<16;++n)t[r+n]=s[n];return t}return ts(s)}var je=jo;var Ee=class{constructor(t,r,s,n,i,a){this.label=t,this.userName=r,this.email=s,this.selected=n,this.detail=a,this.id=je(),this.signingKey=i}};function ns(e){return!e||e.length===0}function Pe(e){return e&&e.replace("$(check)","").trim()}function is(e){return!e||/^\s*$/.test(e)}function os(e,t=!0){if(ns(e)||is(e))return V.ENTER_A_VALID_STRING;if(t&&gs(e))return`Profile with the same name '${e}' already exists!`}function as(e){if(ns(e)||is(e))return V.ENTER_A_VALID_STRING}function us(e){if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))return V.NOT_A_VALID_EMAIL}function cs(e){return{label:e.label.replace("$(check)","").trim(),email:e.email.trim(),userName:e.userName.trim(),selected:e.selected,detail:void 0,id:e.id,signingKey:e.signingKey?.trim()}}function ut(e,t){if(e==null||t===null||t===void 0)return{result:!1,message:"One of the profiles is undefined. Cannot compare."};let r=!1,s=!1,n=!1;return r=e.userName===t.userName,r?(s=e.email.toLowerCase()===t.email.toLowerCase(),s?(n=e.signingKey.toLowerCase()===t.signingKey.toLowerCase(),n?{result:r&&s&&n,message:"Profiles are in sync."}:{result:!1,message:"Signing keys are different."}):{result:!1,message:"Emails are different."}):{result:!1,message:"User names are different."}}function ls(e){return!(e.email||e.userName)}async function Se(){let e=ae();return{result:await ss.window.showQuickPick(e.map(r=>({label:r.label,userName:r.userName,email:r.email,selected:r.selected,detail:`${r.userName} (${r.email}) `,id:r.id,signingKey:r.signingKey})),{canPickMany:!1,matchOnDetail:!1,ignoreFocusOut:!0,placeHolder:"Select a user profile."})}}async function fs(e){let t=ae(),r=-1;e.id?r=t.findIndex(s=>s.id?.toLowerCase()===e.id?.toLowerCase()):r=t.findIndex(s=>s.label.toLowerCase()===e.label.toLowerCase()),r>-1&&(t.splice(r,1),await at.workspace.getConfiguration("gitConfigUser").update("profiles",t,at.ConfigurationTarget.Global))}async function ms(e){let r={profileEmail:e.email,profileUserName:e.userName,profileName:e.label||"",profileId:e.id||"",profileSelected:e.selected,profileSigningKey:e.signingKey};return await Ge.run(async n=>await ps(n,r,!1)),{label:r.profileName||"",userName:r.profileUserName||"",email:r.profileEmail||"",selected:r.profileSelected||!1,detail:void 0,id:r.profileId||"",signingKey:r.profileSigningKey||""}}async function ds(){let t={};return await Ge.run(async s=>await ps(s,t,!0)),new Ee(t.profileName||"Unknown",t.profileUserName||"",t.profileEmail||"",!1,t.profileSigningKey||"")}async function ct(){return new Promise(()=>{})}async function ps(e,t,r=!0){return t.profileName=await e.showInputBox({title:r?"Create a profile":"Edit profile",step:1,totalSteps:4,prompt:"Enter name for the profile",value:t.profileName||"",placeholder:"Work",validate:s=>os(s,r),shouldResume:ct,ignoreFocusOut:!0}),s=>Wo(s,t,r)}async function Wo(e,t,r=!0){return t.profileUserName=await e.showInputBox({title:r?"Create a profile":"Edit profile",step:2,totalSteps:4,prompt:"Enter the user name",value:t.profileUserName||"",placeholder:"John Smith",validate:as,shouldResume:ct,ignoreFocusOut:!0}),s=>Vo(s,t,r)}async function Vo(e,t,r=!0){return t.profileEmail=await e.showInputBox({title:r?"Create a profile":"Edit profile",step:3,totalSteps:4,prompt:"Enter the email",value:t.profileEmail||"",placeholder:"john.smith@myorg.com",validate:us,shouldResume:ct,ignoreFocusOut:!0}),s=>Ko(s,t,r)}async function Ko(e,t,r=!0){t.profileSigningKey=await e.showInputBox({title:r?"Create a profile":"Edit profile",step:4,totalSteps:4,prompt:"Enter the signing key (optional)",value:t.profileSigningKey||"",placeholder:"MY_SIGNING_KEY",validate:()=>{},shouldResume:ct,ignoreFocusOut:!0})}var hs=require("vscode");var lt=class{constructor(){this.disposables=[]}dispose(){this.disposables.forEach(t=>t.dispose()),this.disposables=[]}registerDisposable(t){this.disposables.push(t)}registerDisposables(...t){this.disposables.push(...t)}};var _=class e extends lt{static get instance(){return e._instance||(e._instance=new e),e._instance}constructor(){super(),this.outputChannel=hs.window.createOutputChannel(fe.APPLICATION_NAME),this.registerDisposable(this.outputChannel)}logInfo(t,r){this.logMessage(t,"INFO"),r&&this.logObject(r)}logWarning(t,r){this.logMessage(t,"WARN"),r&&this.logObject(r)}logError(t,r){this.logMessage(t,"ERROR"),this.outputChannel&&(r instanceof Error?(r.message&&this.outputChannel.appendLine(r.message),r.stack&&this.outputChannel.appendLine(r.stack)):r&&this.outputChannel.appendLine(r))}show(){this.outputChannel&&this.outputChannel.show()}logObject(t){if(this.outputChannel){let r=JSON.stringify(t,null,2).trim();this.outputChannel.appendLine(r)}}logMessage(t,r){if(this.outputChannel){let s=new Date().toLocaleTimeString();this.outputChannel.appendLine(`[${r} - ${s}] ${t}`)}}};function ae(){let e=Zt.workspace.getConfiguration("gitConfigUser").get("profiles");return e&&e.length>0?e:[]}async function Y(e,t){let r=ae();e=cs(e);let s=-1;t?s=r.findIndex(n=>n.id?n.id===t:n.label.toLowerCase()===t.toLowerCase()):(s=r.findIndex(n=>n.id?n.id===e.id:n.label.toLowerCase()===e.label.toLowerCase()),s>-1&&r.forEach(n=>{n.selected=!1,n.label=n.label.replace("$(check)","").trim()})),s>-1?r[s]=e:r.push(e),await Zt.workspace.getConfiguration("gitConfigUser").update("profiles",r,!0)}function gs(e){let t=ae().filter(r=>r.label.toLowerCase()===e.toLowerCase());if(t&&t.length>0)return Object.assign({},t[0])}var ft=class{async execute(){try{let r=await ds();return r?(await Y(r),er.window.showInformationMessage(`Profile '${r.label}' created. \u{1F389}`),{result:r}):{result:void 0}}catch(t){return _.instance.logError(`Error ocurred while creating profile. ${t}`),er.window.showErrorMessage("Error ocurred while creating profile."),{result:void 0,error:t}}}};var tt=$(require("vscode"));var ao=require("path");var Rt=$(Is(),1),Et=$(nr(),1),Zn=require("child_process"),Li=$(or(),1),Ne=$(or(),1),St=Object.defineProperty,_a=Object.defineProperties,ka=Object.getOwnPropertyDescriptor,Ca=Object.getOwnPropertyDescriptors,Er=Object.getOwnPropertyNames,Rs=Object.getOwnPropertySymbols,an=Object.prototype.hasOwnProperty,Ta=Object.prototype.propertyIsEnumerable,Os=(e,t,r)=>t in e?St(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,H=(e,t)=>{for(var r in t||(t={}))an.call(t,r)&&Os(e,r,t[r]);if(Rs)for(var r of Rs(t))Ta.call(t,r)&&Os(e,r,t[r]);return e},Ke=(e,t)=>_a(e,Ca(t)),Ea=e=>St(e,"__esModule",{value:!0}),l=(e,t)=>function(){return e&&(t=(0,e[Er(e)[0]])(e=0)),t},Pa=(e,t)=>function(){return t||(0,e[Er(e)[0]])((t={exports:{}}).exports,t),t.exports},x=(e,t)=>{for(var r in t)St(e,r,{get:t[r],enumerable:!0})},Sa=(e,t,r,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Er(t))!an.call(e,n)&&(r||n!=="default")&&St(e,n,{get:()=>t[n],enumerable:!(s=ka(t,n))||s.enumerable});return e},I=(e=>(t,r)=>e&&e.get(t)||(r=Sa(Ea({}),t,1),e&&e.set(t,r),r))(typeof WeakMap<"u"?new WeakMap:0),Ve=(e,t,r)=>new Promise((s,n)=>{var i=d=>{try{o(r.next(d))}catch(p){n(p)}},a=d=>{try{o(r.throw(d))}catch(p){n(p)}},o=d=>d.done?s(d.value):Promise.resolve(d.value).then(i,a);o((r=r.apply(e,t)).next())});function Ia(...e){let t=new String(e);return It.set(t,e),t}function Ct(e){return e instanceof String&&It.has(e)}function xs(e){return It.get(e)||[]}var It,Ye=l({"src/lib/args/pathspec.ts"(){It=new WeakMap}}),ue,ge=l({"src/lib/errors/git-error.ts"(){ue=class extends Error{constructor(e,t){super(t),this.task=e,Object.setPrototypeOf(this,new.target.prototype)}}}}),He,Me=l({"src/lib/errors/git-response-error.ts"(){ge(),He=class extends ue{constructor(e,t){super(void 0,t||String(e)),this.git=e}}}}),un,cn=l({"src/lib/errors/task-configuration-error.ts"(){ge(),un=class extends ue{constructor(e){super(void 0,e)}}}});function ln(e){return typeof e=="function"?e:ke}function fn(e){return typeof e=="function"&&e!==ke}function mn(e,t){let r=e.indexOf(t);return r<=0?[e,""]:[e.substr(0,r),e.substr(r+1)]}function dn(e,t=0){return pn(e)&&e.length>t?e[t]:void 0}function _e(e,t=0){if(pn(e)&&e.length>t)return e[e.length-1-t]}function pn(e){return!!(e&&typeof e.length=="number")}function Je(e="",t=!0,r=`
`){return e.split(r).reduce((s,n)=>{let i=t?n.trim():n;return i&&s.push(i),s},[])}function Pr(e,t){return Je(e,!0).map(r=>t(r))}function Sr(e){return(0,Rt.exists)(e,Rt.FOLDER)}function k(e,t){return Array.isArray(e)?e.includes(t)||e.push(t):e.add(t),t}function gn(e,t){return Array.isArray(e)&&!e.includes(t)&&e.push(t),e}function Ot(e,t){if(Array.isArray(e)){let r=e.indexOf(t);r>=0&&e.splice(r,1)}else e.delete(t);return t}function pe(e){return Array.isArray(e)?e:[e]}function hn(e){return pe(e).map(String)}function E(e,t=0){if(e==null)return t;let r=parseInt(e,10);return isNaN(r)?t:r}function qe(e,t){let r=[];for(let s=0,n=e.length;s<n;s++)r.push(t,e[s]);return r}function ze(e){return(Array.isArray(e)?Buffer.concat(e):e).toString("utf-8")}function vn(e,t){return Object.assign({},...t.map(r=>r in e?{[r]:e[r]}:{}))}function dr(e=0){return new Promise(t=>setTimeout(t,e))}function wn(e){if(e!==!1)return e}var Le,ke,Xe,xt=l({"src/lib/utils/util.ts"(){Le="\0",ke=()=>{},Xe=Object.prototype.toString.call.bind(Object.prototype.toString)}});function se(e,t,r){return t(e)?e:arguments.length>2?r:void 0}function Ir(e,t){let r=Ct(e)?"string":typeof e;return/number|string|boolean/.test(r)&&(!t||!t.includes(r))}function Rr(e){return!!e&&Xe(e)==="[object Object]"}function yn(e){return typeof e=="function"}var Ze,L,bn,Tt,Or,_n=l({"src/lib/utils/argument-filters.ts"(){xt(),Ye(),Ze=e=>Array.isArray(e),L=e=>typeof e=="string",bn=e=>Array.isArray(e)&&e.every(L),Tt=e=>L(e)||Array.isArray(e)&&e.every(L),Or=e=>e==null||"number|boolean|function".includes(typeof e)?!1:Array.isArray(e)||typeof e=="string"||typeof e.length=="number"}}),pr,Ra=l({"src/lib/utils/exit-codes.ts"(){pr=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.ERROR=1]="ERROR",e[e.NOT_FOUND=-2]="NOT_FOUND",e[e.UNCLEAN=128]="UNCLEAN",e))(pr||{})}}),Qe,Oa=l({"src/lib/utils/git-output-streams.ts"(){Qe=class{constructor(e,t){this.stdOut=e,this.stdErr=t}asStrings(){return new Qe(this.stdOut.toString("utf8"),this.stdErr.toString("utf8"))}}}}),y,de,xa=l({"src/lib/utils/line-parser.ts"(){y=class{constructor(e,t){this.matches=[],this.parse=(r,s)=>(this.resetMatches(),this._regExp.every((n,i)=>this.addMatch(n,i,r(i)))?this.useMatches(s,this.prepareMatches())!==!1:!1),this._regExp=Array.isArray(e)?e:[e],t&&(this.useMatches=t)}useMatches(e,t){throw new Error("LineParser:useMatches not implemented")}resetMatches(){this.matches.length=0}prepareMatches(){return this.matches}addMatch(e,t,r){let s=r&&e.exec(r);return s&&this.pushMatch(t,s),!!s}pushMatch(e,t){this.matches.push(...t.slice(1))}},de=class extends y{addMatch(e,t,r){return/^remote:\s/.test(String(r))&&super.addMatch(e,t,r)}pushMatch(e,t){(e>0||t.length>1)&&super.pushMatch(e,t)}}}});function kn(...e){let t=process.cwd(),r=Object.assign(H({baseDir:t},Cn),...e.filter(s=>typeof s=="object"&&s));return r.baseDir=r.baseDir||t,r.trimmed=r.trimmed===!0,r}var Cn,Aa=l({"src/lib/utils/simple-git-options.ts"(){Cn={binary:"git",maxConcurrentProcesses:5,config:[],trimmed:!1}}});function xr(e,t=[]){return Rr(e)?Object.keys(e).reduce((r,s)=>{let n=e[s];return Ct(n)?r.push(n):Ir(n,["boolean"])?r.push(s+"="+n):r.push(s),r},t):t}function G(e,t=0,r=!1){let s=[];for(let n=0,i=t<0?e.length:t;n<i;n++)"string|number".includes(typeof e[n])&&s.push(String(e[n]));return xr(Ar(e),s),r||s.push(...Fa(e)),s}function Fa(e){let t=typeof _e(e)=="function";return se(_e(e,t?1:0),Ze,[])}function Ar(e){let t=yn(_e(e));return se(_e(e,t?1:0),Rr)}function R(e,t=!0){let r=ln(_e(e));return t||fn(r)?r:void 0}var Na=l({"src/lib/utils/task-options.ts"(){_n(),xt(),Ye()}});function gr(e,t){return e(t.stdOut,t.stdErr)}function Q(e,t,r,s=!0){return pe(r).forEach(n=>{for(let i=Je(n,s),a=0,o=i.length;a<o;a++){let d=(p=0)=>{if(!(a+p>=o))return i[a+p]};t.some(({parse:p})=>p(d,e))}}),e}var La=l({"src/lib/utils/task-parser.ts"(){xt()}}),Tn={};x(Tn,{ExitCodes:()=>pr,GitOutputStreams:()=>Qe,LineParser:()=>y,NOOP:()=>ke,NULL:()=>Le,RemoteLineParser:()=>de,append:()=>k,appendTaskOptions:()=>xr,asArray:()=>pe,asFunction:()=>ln,asNumber:()=>E,asStringArray:()=>hn,bufferToString:()=>ze,callTaskParser:()=>gr,createInstanceConfig:()=>kn,delay:()=>dr,filterArray:()=>Ze,filterFunction:()=>yn,filterHasLength:()=>Or,filterPlainObject:()=>Rr,filterPrimitives:()=>Ir,filterString:()=>L,filterStringArray:()=>bn,filterStringOrStringArray:()=>Tt,filterType:()=>se,first:()=>dn,folderExists:()=>Sr,forEachLineWithContent:()=>Pr,getTrailingOptions:()=>G,including:()=>gn,isUserFunction:()=>fn,last:()=>_e,objectToString:()=>Xe,orVoid:()=>wn,parseStringResponse:()=>Q,pick:()=>vn,prefixedArray:()=>qe,remove:()=>Ot,splitOn:()=>mn,toLinesWithContent:()=>Je,trailingFunctionArgument:()=>R,trailingOptionsArgument:()=>Ar});var w=l({"src/lib/utils/index.ts"(){_n(),Ra(),Oa(),xa(),Aa(),Na(),La(),xt()}}),En={};x(En,{CheckRepoActions:()=>hr,checkIsBareRepoTask:()=>Sn,checkIsRepoRootTask:()=>Pn,checkIsRepoTask:()=>Ma});function Ma(e){switch(e){case"bare":return Sn();case"root":return Pn()}return{commands:["rev-parse","--is-inside-work-tree"],format:"utf-8",onError:At,parser:Fr}}function Pn(){return{commands:["rev-parse","--git-dir"],format:"utf-8",onError:At,parser(t){return/^\.(git)?$/.test(t.trim())}}}function Sn(){return{commands:["rev-parse","--is-bare-repository"],format:"utf-8",onError:At,parser:Fr}}function Da(e){return/(Not a git repository|Kein Git-Repository)/i.test(String(e))}var hr,At,Fr,In=l({"src/lib/tasks/check-is-repo.ts"(){w(),hr=(e=>(e.BARE="bare",e.IN_TREE="tree",e.IS_REPO_ROOT="root",e))(hr||{}),At=({exitCode:e},t,r,s)=>{if(e===128&&Da(t))return r(Buffer.from("false"));s(t)},Fr=e=>e.trim()==="true"}});function $a(e,t){let r=new Rn(e),s=e?xn:On;return Je(t).forEach(n=>{let i=n.replace(s,"");r.paths.push(i),(An.test(i)?r.folders:r.files).push(i)}),r}var Rn,On,xn,An,Ba=l({"src/lib/responses/CleanSummary.ts"(){w(),Rn=class{constructor(e){this.dryRun=e,this.paths=[],this.files=[],this.folders=[]}},On=/^[a-z]+\s*/i,xn=/^[a-z]+\s+[a-z]+\s*/i,An=/\/$/}}),vr={};x(vr,{EMPTY_COMMANDS:()=>Ft,adhocExecTask:()=>Fn,configurationErrorTask:()=>j,isBufferTask:()=>Ln,isEmptyTask:()=>Mn,straightThroughBufferTask:()=>Nn,straightThroughStringTask:()=>B});function Fn(e){return{commands:Ft,format:"empty",parser:e}}function j(e){return{commands:Ft,format:"empty",parser(){throw typeof e=="string"?new un(e):e}}}function B(e,t=!1){return{commands:e,format:"utf-8",parser(r){return t?String(r).trim():r}}}function Nn(e){return{commands:e,format:"buffer",parser(t){return t}}}function Ln(e){return e.format==="buffer"}function Mn(e){return e.format==="empty"||!e.commands.length}var Ft,O=l({"src/lib/tasks/task.ts"(){cn(),Ft=[]}}),Dn={};x(Dn,{CONFIG_ERROR_INTERACTIVE_MODE:()=>Nr,CONFIG_ERROR_MODE_REQUIRED:()=>Lr,CONFIG_ERROR_UNKNOWN_OPTION:()=>Mr,CleanOptions:()=>yt,cleanTask:()=>$n,cleanWithOptionsTask:()=>Ua,isCleanOptionsArray:()=>Ga});function Ua(e,t){let{cleanMode:r,options:s,valid:n}=ja(e);return r?n.options?(s.push(...t),s.some(Ka)?j(Nr):$n(r,s)):j(Mr+JSON.stringify(e)):j(Lr)}function $n(e,t){return{commands:["clean",`-${e}`,...t],format:"utf-8",parser(s){return $a(e==="n",s)}}}function Ga(e){return Array.isArray(e)&&e.every(t=>Dr.has(t))}function ja(e){let t,r=[],s={cleanMode:!1,options:!0};return e.replace(/[^a-z]i/g,"").split("").forEach(n=>{Wa(n)?(t=n,s.cleanMode=!0):s.options=s.options&&Va(r[r.length]=`-${n}`)}),{cleanMode:t,options:r,valid:s}}function Wa(e){return e==="f"||e==="n"}function Va(e){return/^-[a-z]$/i.test(e)&&Dr.has(e.charAt(1))}function Ka(e){return/^-[^\-]/.test(e)?e.indexOf("i")>0:e==="--interactive"}var Nr,Lr,Mr,yt,Dr,Bn=l({"src/lib/tasks/clean.ts"(){Ba(),w(),O(),Nr="Git clean interactive mode is not supported",Lr='Git clean mode parameter ("n" or "f") is required',Mr="Git clean unknown option found in: ",yt=(e=>(e.DRY_RUN="n",e.FORCE="f",e.IGNORED_INCLUDED="x",e.IGNORED_ONLY="X",e.EXCLUDING="e",e.QUIET="q",e.RECURSIVE="d",e))(yt||{}),Dr=new Set(["i",...hn(Object.values(yt))])}});function qa(e){let t=new Gn;for(let r of Un(e))t.addValue(r.file,String(r.key),r.value);return t}function za(e,t){let r=null,s=[],n=new Map;for(let i of Un(e,t))i.key===t&&(s.push(r=i.value),n.has(i.file)||n.set(i.file,[]),n.get(i.file).push(r));return{key:t,paths:Array.from(n.keys()),scopes:n,value:r,values:s}}function Qa(e){return e.replace(/^(file):/,"")}function*Un(e,t=null){let r=e.split("\0");for(let s=0,n=r.length-1;s<n;){let i=Qa(r[s++]),a=r[s++],o=t;if(a.includes(`
`)){let d=mn(a,`
`);o=d[0],a=d[1]}yield{file:i,key:o,value:a}}}var Gn,Ya=l({"src/lib/responses/ConfigList.ts"(){w(),Gn=class{constructor(){this.files=[],this.values=Object.create(null)}get all(){return this._all||(this._all=this.files.reduce((e,t)=>Object.assign(e,this.values[t]),{})),this._all}addFile(e){if(!(e in this.values)){let t=_e(this.files);this.values[e]=t?Object.create(this.values[t]):{},this.files.push(e)}return this.values[e]}addValue(e,t,r){let s=this.addFile(e);s.hasOwnProperty(t)?Array.isArray(s[t])?s[t].push(r):s[t]=[s[t],r]:s[t]=r,this._all=void 0}}}});function ar(e,t){return typeof e=="string"&&wr.hasOwnProperty(e)?e:t}function Ha(e,t,r,s){let n=["config",`--${s}`];return r&&n.push("--add"),n.push(e,t),{commands:n,format:"utf-8",parser(i){return i}}}function Ja(e,t){let r=["config","--null","--show-origin","--get-all",e];return t&&r.splice(1,0,`--${t}`),{commands:r,format:"utf-8",parser(s){return za(s,e)}}}function Xa(e){let t=["config","--list","--show-origin","--null"];return e&&t.push(`--${e}`),{commands:t,format:"utf-8",parser(r){return qa(r)}}}function Za(){return{addConfig(e,t,...r){return this._runTask(Ha(e,t,r[0]===!0,ar(r[1],"local")),R(arguments))},getConfig(e,t){return this._runTask(Ja(e,ar(t,void 0)),R(arguments))},listConfig(...e){return this._runTask(Xa(ar(e[0],void 0)),R(arguments))}}}var wr,jn=l({"src/lib/tasks/config.ts"(){Ya(),w(),wr=(e=>(e.system="system",e.global="global",e.local="local",e.worktree="worktree",e))(wr||{})}});function eu(e){return Wn.has(e)}var ur,Wn,Vn=l({"src/lib/tasks/diff-name-status.ts"(){ur=(e=>(e.ADDED="A",e.COPIED="C",e.DELETED="D",e.MODIFIED="M",e.RENAMED="R",e.CHANGED="T",e.UNMERGED="U",e.UNKNOWN="X",e.BROKEN="B",e))(ur||{}),Wn=new Set(Object.values(ur))}});function tu(...e){return new qn().param(...e)}function ru(e){let t=new Set,r={};return Pr(e,s=>{let[n,i,a]=s.split(Le);t.add(n),(r[n]=r[n]||[]).push({line:E(i),path:n,preview:a})}),{paths:t,results:r}}function su(){return{grep(e){let t=R(arguments),r=G(arguments);for(let n of Kn)if(r.includes(n))return this._runTask(j(`git.grep: use of "${n}" is not supported.`),t);typeof e=="string"&&(e=tu().param(e));let s=["grep","--null","-n","--full-name",...r,...e];return this._runTask({commands:s,format:"utf-8",parser(n){return ru(n)}},t)}}}var Kn,We,As,qn,zn=l({"src/lib/tasks/grep.ts"(){w(),O(),Kn=["-h"],We=Symbol("grepQuery"),qn=class{constructor(){this[As]=[]}*[(As=We,Symbol.iterator)](){for(let e of this[We])yield e}and(...e){return e.length&&this[We].push("--and","(",...qe(e,"-e"),")"),this}param(...e){return this[We].push(...qe(e,"-e")),this}}}}),Qn={};x(Qn,{ResetMode:()=>bt,getResetMode:()=>iu,resetTask:()=>nu});function nu(e,t){let r=["reset"];return Yn(e)&&r.push(`--${e}`),r.push(...t),B(r)}function iu(e){if(Yn(e))return e;switch(typeof e){case"string":case"undefined":return"soft"}}function Yn(e){return Hn.includes(e)}var bt,Hn,Jn=l({"src/lib/tasks/reset.ts"(){O(),bt=(e=>(e.MIXED="mixed",e.SOFT="soft",e.HARD="hard",e.MERGE="merge",e.KEEP="keep",e))(bt||{}),Hn=Array.from(Object.values(bt))}});function ou(){return(0,Et.default)("simple-git")}function Fs(e,t,r){return!t||!String(t).replace(/\s*/,"")?r?(s,...n)=>{e(s,...n),r(s,...n)}:e:(s,...n)=>{e(`%s ${s}`,t,...n),r&&r(s,...n)}}function au(e,t,{namespace:r}){if(typeof e=="string")return e;let s=t&&t.namespace||"";return s.startsWith(r)?s.substr(r.length+1):s||r}function $r(e,t,r,s=ou()){let n=e&&`[${e}]`||"",i=[],a=typeof t=="string"?s.extend(t):t,o=au(se(t,L),a,s);return p(r);function d(c,f){return k(i,$r(e,o.replace(/^[^:]+/,c),f,s))}function p(c){let f=c&&`[${c}]`||"",m=a&&Fs(a,f)||ke,g=Fs(s,`${n} ${f}`,m);return Object.assign(a?m:g,{label:e,sibling:d,info:g,step:p})}}var Xn=l({"src/lib/git-logger.ts"(){w(),Et.default.formatters.L=e=>String(Or(e)?e.length:"-"),Et.default.formatters.B=e=>Buffer.isBuffer(e)?e.toString("utf8"):Xe(e)}}),vt,yr,uu=l({"src/lib/runners/tasks-pending-queue.ts"(){ge(),Xn(),vt=class{constructor(e="GitExecutor"){this.logLabel=e,this._queue=new Map}withProgress(e){return this._queue.get(e)}createProgress(e){let t=vt.getName(e.commands[0]),r=$r(this.logLabel,t);return{task:e,logger:r,name:t}}push(e){let t=this.createProgress(e);return t.logger("Adding task to the queue, commands = %o",e.commands),this._queue.set(e,t),t}fatal(e){for(let[t,{logger:r}]of Array.from(this._queue.entries()))t===e.task?(r.info("Failed %o",e),r("Fatal exception, any as-yet un-started tasks run through this executor will not be attempted")):r.info("A fatal exception occurred in a previous task, the queue has been purged: %o",e.message),this.complete(t);if(this._queue.size!==0)throw new Error(`Queue size should be zero after fatal: ${this._queue.size}`)}complete(e){this.withProgress(e)&&this._queue.delete(e)}attempt(e){let t=this.withProgress(e);if(!t)throw new ue(void 0,"TasksPendingQueue: attempt called for an unknown task");return t.logger("Starting task"),t}static getName(e="empty"){return`task:${e}:${++vt.counter}`}},yr=vt,yr.counter=0}});function Fe(e,t){return{method:dn(e.commands)||"",commands:t}}function cu(e,t){return r=>{t("[ERROR] child process exception %o",r),e.push(Buffer.from(String(r.stack),"ascii"))}}function Ns(e,t,r,s){return n=>{r("%s received %L bytes",t,n),s("%B",n),e.push(n)}}var br,lu=l({"src/lib/runners/git-executor-chain.ts"(){ge(),O(),w(),uu(),br=class{constructor(e,t,r){this._executor=e,this._scheduler=t,this._plugins=r,this._chain=Promise.resolve(),this._queue=new yr}get binary(){return this._executor.binary}get cwd(){return this._cwd||this._executor.cwd}set cwd(e){this._cwd=e}get env(){return this._executor.env}get outputHandler(){return this._executor.outputHandler}chain(){return this}push(e){return this._queue.push(e),this._chain=this._chain.then(()=>this.attemptTask(e))}attemptTask(e){return Ve(this,null,function*(){let t=yield this._scheduler.next(),r=()=>this._queue.complete(e);try{let{logger:s}=this._queue.attempt(e);return yield Mn(e)?this.attemptEmptyTask(e,s):this.attemptRemoteTask(e,s)}catch(s){throw this.onFatalException(e,s)}finally{r(),t()}})}onFatalException(e,t){let r=t instanceof ue?Object.assign(t,{task:e}):new ue(e,t&&String(t));return this._chain=Promise.resolve(),this._queue.fatal(r),r}attemptRemoteTask(e,t){return Ve(this,null,function*(){let r=this._plugins.exec("spawn.args",[...e.commands],Fe(e,e.commands)),s=yield this.gitResponse(e,this.binary,r,this.outputHandler,t.step("SPAWN")),n=yield this.handleTaskData(e,r,s,t.step("HANDLE"));return t("passing response to task's parser as a %s",e.format),Ln(e)?gr(e.parser,n):gr(e.parser,n.asStrings())})}attemptEmptyTask(e,t){return Ve(this,null,function*(){return t("empty task bypassing child process to call to task's parser"),e.parser(this)})}handleTaskData(e,t,r,s){let{exitCode:n,rejection:i,stdOut:a,stdErr:o}=r;return new Promise((d,p)=>{s("Preparing to handle process response exitCode=%d stdOut=",n);let{error:c}=this._plugins.exec("task.error",{error:i},H(H({},Fe(e,t)),r));if(c&&e.onError)return s.info("exitCode=%s handling with custom error handler"),e.onError(r,c,f=>{s.info("custom error handler treated as success"),s("custom error returned a %s",Xe(f)),d(new Qe(Array.isArray(f)?Buffer.concat(f):f,Buffer.concat(o)))},p);if(c)return s.info("handling as error: exitCode=%s stdErr=%s rejection=%o",n,o.length,i),p(c);s.info("retrieving task output complete"),d(new Qe(Buffer.concat(a),Buffer.concat(o)))})}gitResponse(e,t,r,s,n){return Ve(this,null,function*(){let i=n.sibling("output"),a=this._plugins.exec("spawn.options",{cwd:this.cwd,env:this.env,windowsHide:!0},Fe(e,e.commands));return new Promise(o=>{let d=[],p=[];n.info("%s %o",t,r),n("%O",a);let c=this._beforeSpawn(e,r);if(c)return o({stdOut:d,stdErr:p,exitCode:9901,rejection:c});this._plugins.exec("spawn.before",void 0,Ke(H({},Fe(e,r)),{kill(m){c=m||c}}));let f=(0,Zn.spawn)(t,r,a);f.stdout.on("data",Ns(d,"stdOut",n,i.step("stdOut"))),f.stderr.on("data",Ns(p,"stdErr",n,i.step("stdErr"))),f.on("error",cu(p,n)),s&&(n("Passing child process stdOut/stdErr to custom outputHandler"),s(t,f.stdout,f.stderr,[...r])),this._plugins.exec("spawn.after",void 0,Ke(H({},Fe(e,r)),{spawned:f,close(m,g){o({stdOut:d,stdErr:p,exitCode:m,rejection:c||g})},kill(m){f.killed||(c=m,f.kill("SIGINT"))}}))})})}_beforeSpawn(e,t){let r;return this._plugins.exec("spawn.before",void 0,Ke(H({},Fe(e,t)),{kill(s){r=s||r}})),r}}}}),ei={};x(ei,{GitExecutor:()=>ti});var ti,fu=l({"src/lib/runners/git-executor.ts"(){lu(),ti=class{constructor(e="git",t,r,s){this.binary=e,this.cwd=t,this._scheduler=r,this._plugins=s,this._chain=new br(this,this._scheduler,this._plugins)}chain(){return new br(this,this._scheduler,this._plugins)}push(e){return this._chain.push(e)}}}});function mu(e,t,r=ke){let s=i=>{r(null,i)},n=i=>{i?.task===e&&r(i instanceof He?du(i):i,void 0)};t.then(s,n)}function du(e){let t=s=>{console.warn(`simple-git deprecation notice: accessing GitResponseError.${s} should be GitResponseError.git.${s}, this will no longer be available in version 3`),t=ke};return Object.create(e,Object.getOwnPropertyNames(e.git).reduce(r,{}));function r(s,n){return n in e||(s[n]={enumerable:!1,configurable:!1,get(){return t(n),e.git[n]}}),s}}var pu=l({"src/lib/task-callback.ts"(){Me(),w()}});function Ls(e,t){return Fn(r=>{if(!Sr(e))throw new Error(`Git.cwd: cannot change to non-directory "${e}"`);return(t||r).cwd=e})}var gu=l({"src/lib/tasks/change-working-directory.ts"(){w(),O()}});function cr(e){let t=["checkout",...e];return t[1]==="-b"&&t.includes("-B")&&(t[1]=Ot(t,"-B")),B(t)}function hu(){return{checkout(){return this._runTask(cr(G(arguments,1)),R(arguments))},checkoutBranch(e,t){return this._runTask(cr(["-b",e,t,...G(arguments)]),R(arguments))},checkoutLocalBranch(e){return this._runTask(cr(["-b",e,...G(arguments)]),R(arguments))}}}var vu=l({"src/lib/tasks/checkout.ts"(){w(),O()}});function wu(e){return Q({author:null,branch:"",commit:"",root:!1,summary:{changes:0,insertions:0,deletions:0}},ri,e)}var ri,yu=l({"src/lib/parsers/parse-commit.ts"(){w(),ri=[new y(/^\[([^\s]+)( \([^)]+\))? ([^\]]+)/,(e,[t,r,s])=>{e.branch=t,e.commit=s,e.root=!!r}),new y(/\s*Author:\s(.+)/i,(e,[t])=>{let r=t.split("<"),s=r.pop();!s||!s.includes("@")||(e.author={email:s.substr(0,s.length-1),name:r.join("<").trim()})}),new y(/(\d+)[^,]*(?:,\s*(\d+)[^,]*)(?:,\s*(\d+))/g,(e,[t,r,s])=>{e.summary.changes=parseInt(t,10)||0,e.summary.insertions=parseInt(r,10)||0,e.summary.deletions=parseInt(s,10)||0}),new y(/^(\d+)[^,]*(?:,\s*(\d+)[^(]+\(([+-]))?/,(e,[t,r,s])=>{e.summary.changes=parseInt(t,10)||0;let n=parseInt(r,10)||0;s==="-"?e.summary.deletions=n:s==="+"&&(e.summary.insertions=n)})]}});function bu(e,t,r){return{commands:["-c","core.abbrev=40","commit",...qe(e,"-m"),...t,...r],format:"utf-8",parser:wu}}function _u(){return{commit(t,...r){let s=R(arguments),n=e(t)||bu(pe(t),pe(se(r[0],Tt,[])),[...se(r[1],Ze,[]),...G(arguments,0,!0)]);return this._runTask(n,s)}};function e(t){return!Tt(t)&&j("git.commit: requires the commit message to be supplied as a string/string[]")}}var ku=l({"src/lib/tasks/commit.ts"(){yu(),w(),O()}});function Cu(){return{firstCommit(){return this._runTask(B(["rev-list","--max-parents=0","HEAD"],!0),R(arguments))}}}var Tu=l({"src/lib/tasks/first-commit.ts"(){w(),O()}});function Eu(e,t){let r=["hash-object",e];return t&&r.push("-w"),B(r,!0)}var Pu=l({"src/lib/tasks/hash-object.ts"(){O()}});function Su(e,t,r){let s=String(r).trim(),n;if(n=si.exec(s))return new _t(e,t,!1,n[1]);if(n=ni.exec(s))return new _t(e,t,!0,n[1]);let i="",a=s.split(" ");for(;a.length;)if(a.shift()==="in"){i=a.join(" ");break}return new _t(e,t,/^re/i.test(s),i)}var _t,si,ni,Iu=l({"src/lib/responses/InitSummary.ts"(){_t=class{constructor(e,t,r,s){this.bare=e,this.path=t,this.existing=r,this.gitDir=s}},si=/^Init.+ repository in (.+)$/,ni=/^Rein.+ in (.+)$/}});function Ru(e){return e.includes(Br)}function Ou(e=!1,t,r){let s=["init",...r];return e&&!Ru(s)&&s.splice(1,0,Br),{commands:s,format:"utf-8",parser(n){return Su(s.includes("--bare"),t,n)}}}var Br,xu=l({"src/lib/tasks/init.ts"(){Iu(),Br="--bare"}});function Ur(e){for(let t=0;t<e.length;t++){let r=Gr.exec(e[t]);if(r)return`--${r[1]}`}return""}function Au(e){return Gr.test(e)}var Gr,et=l({"src/lib/args/log-format.ts"(){Gr=/^--(stat|numstat|name-only|name-status)(=|$)/}}),ii,Fu=l({"src/lib/responses/DiffSummary.ts"(){ii=class{constructor(){this.changed=0,this.deletions=0,this.insertions=0,this.files=[]}}}});function oi(e=""){let t=ai[e];return r=>Q(new ii,t,r,!1)}var lr,Ms,Ds,$s,ai,ui=l({"src/lib/parsers/parse-diff-summary.ts"(){et(),Fu(),Vn(),w(),lr=[new y(/(.+)\s+\|\s+(\d+)(\s+[+\-]+)?$/,(e,[t,r,s=""])=>{e.files.push({file:t.trim(),changes:E(r),insertions:s.replace(/[^+]/g,"").length,deletions:s.replace(/[^-]/g,"").length,binary:!1})}),new y(/(.+) \|\s+Bin ([0-9.]+) -> ([0-9.]+) ([a-z]+)/,(e,[t,r,s])=>{e.files.push({file:t.trim(),before:E(r),after:E(s),binary:!0})}),new y(/(\d+) files? changed\s*((?:, \d+ [^,]+){0,2})/,(e,[t,r])=>{let s=/(\d+) i/.exec(r),n=/(\d+) d/.exec(r);e.changed=E(t),e.insertions=E(s?.[1]),e.deletions=E(n?.[1])})],Ms=[new y(/(\d+)\t(\d+)\t(.+)$/,(e,[t,r,s])=>{let n=E(t),i=E(r);e.changed++,e.insertions+=n,e.deletions+=i,e.files.push({file:s,changes:n+i,insertions:n,deletions:i,binary:!1})}),new y(/-\t-\t(.+)$/,(e,[t])=>{e.changed++,e.files.push({file:t,after:0,before:0,binary:!0})})],Ds=[new y(/(.+)$/,(e,[t])=>{e.changed++,e.files.push({file:t,changes:0,insertions:0,deletions:0,binary:!1})})],$s=[new y(/([ACDMRTUXB])([0-9]{0,3})\t(.[^\t]*)(\t(.[^\t]*))?$/,(e,[t,r,s,n,i])=>{e.changed++,e.files.push({file:i??s,changes:0,status:wn(eu(t)&&t),insertions:0,deletions:0,binary:!1})})],ai={"":lr,"--stat":lr,"--numstat":Ms,"--name-status":$s,"--name-only":Ds}}});function Nu(e,t){return t.reduce((r,s,n)=>(r[s]=e[n]||"",r),Object.create({diff:null}))}function ci(e=Vr,t=li,r=""){let s=oi(r);return function(n){let i=Je(n,!0,jr).map(function(a){let o=a.trim().split(Wr),d=Nu(o[0].trim().split(e),t);return o.length>1&&o[1].trim()&&(d.diff=s(o[1])),d});return{all:i,latest:i.length&&i[0]||null,total:i.length}}}var jr,Wr,Vr,li,fi=l({"src/lib/parsers/parse-list-log-summary.ts"(){w(),ui(),et(),jr="\xF2\xF2\xF2\xF2\xF2\xF2 ",Wr=" \xF2\xF2",Vr=" \xF2 ",li=["hash","date","message","refs","author_name","author_email"]}}),mi={};x(mi,{diffSummaryTask:()=>Lu,validateLogFormatConfig:()=>Nt});function Lu(e){let t=Ur(e),r=["diff"];return t===""&&(t="--stat",r.push("--stat=4096")),r.push(...e),Nt(r)||{commands:r,format:"utf-8",parser:oi(t)}}function Nt(e){let t=e.filter(Au);if(t.length>1)return j(`Summary flags are mutually exclusive - pick one of ${t.join(",")}`);if(t.length&&e.includes("-z"))return j(`Summary flag ${t} parsing is not compatible with null termination option '-z'`)}var Kr=l({"src/lib/tasks/diff.ts"(){et(),ui(),O()}});function Mu(e,t){let r=[],s=[];return Object.keys(e).forEach(n=>{r.push(n),s.push(String(e[n]))}),[r,s.join(t)]}function Du(e){return Object.keys(e).reduce((t,r)=>(r in _r||(t[r]=e[r]),t),{})}function di(e={},t=[]){let r=se(e.splitter,L,Vr),s=!Ir(e.format)&&e.format?e.format:{hash:"%H",date:e.strictDate===!1?"%ai":"%aI",message:"%s",refs:"%D",body:e.multiLine?"%B":"%b",author_name:e.mailMap!==!1?"%aN":"%an",author_email:e.mailMap!==!1?"%aE":"%ae"},[n,i]=Mu(s,r),a=[],o=[`--pretty=format:${jr}${i}${Wr}`,...t],d=e.n||e["max-count"]||e.maxCount;if(d&&o.push(`--max-count=${d}`),e.from||e.to){let p=e.symmetric!==!1?"...":"..";a.push(`${e.from||""}${p}${e.to||""}`)}return L(e.file)&&o.push("--follow",Ia(e.file)),xr(Du(e),o),{fields:n,splitter:r,commands:[...o,...a]}}function $u(e,t,r){let s=ci(e,t,Ur(r));return{commands:["log",...r],format:"utf-8",parser:s}}function Bu(){return{log(...r){let s=R(arguments),n=di(Ar(arguments),se(arguments[0],Ze)),i=t(...r)||Nt(n.commands)||e(n);return this._runTask(i,s)}};function e(r){return $u(r.splitter,r.fields,r.commands)}function t(r,s){return L(r)&&L(s)&&j("git.log(string, string) should be replaced with git.log({ from: string, to: string })")}}var _r,pi=l({"src/lib/tasks/log.ts"(){et(),Ye(),fi(),w(),O(),Kr(),_r=(e=>(e[e["--pretty"]=0]="--pretty",e[e["max-count"]=1]="max-count",e[e.maxCount=2]="maxCount",e[e.n=3]="n",e[e.file=4]="file",e[e.format=5]="format",e[e.from=6]="from",e[e.to=7]="to",e[e.splitter=8]="splitter",e[e.symmetric=9]="symmetric",e[e.mailMap=10]="mailMap",e[e.multiLine=11]="multiLine",e[e.strictDate=12]="strictDate",e))(_r||{})}}),kt,gi,Uu=l({"src/lib/responses/MergeSummary.ts"(){kt=class{constructor(e,t=null,r){this.reason=e,this.file=t,this.meta=r}toString(){return`${this.file}:${this.reason}`}},gi=class{constructor(){this.conflicts=[],this.merges=[],this.result="success"}get failed(){return this.conflicts.length>0}get reason(){return this.result}toString(){return this.conflicts.length?`CONFLICTS: ${this.conflicts.join(", ")}`:"OK"}}}}),kr,hi,Gu=l({"src/lib/responses/PullSummary.ts"(){kr=class{constructor(){this.remoteMessages={all:[]},this.created=[],this.deleted=[],this.files=[],this.deletions={},this.insertions={},this.summary={changes:0,deletions:0,insertions:0}}},hi=class{constructor(){this.remote="",this.hash={local:"",remote:""},this.branch={local:"",remote:""},this.message=""}toString(){return this.message}}}});function fr(e){return e.objects=e.objects||{compressing:0,counting:0,enumerating:0,packReused:0,reused:{count:0,delta:0},total:{count:0,delta:0}}}function Bs(e){let t=/^\s*(\d+)/.exec(e),r=/delta (\d+)/i.exec(e);return{count:E(t&&t[1]||"0"),delta:E(r&&r[1]||"0")}}var vi,ju=l({"src/lib/parsers/parse-remote-objects.ts"(){w(),vi=[new de(/^remote:\s*(enumerating|counting|compressing) objects: (\d+),/i,(e,[t,r])=>{let s=t.toLowerCase(),n=fr(e.remoteMessages);Object.assign(n,{[s]:E(r)})}),new de(/^remote:\s*(enumerating|counting|compressing) objects: \d+% \(\d+\/(\d+)\),/i,(e,[t,r])=>{let s=t.toLowerCase(),n=fr(e.remoteMessages);Object.assign(n,{[s]:E(r)})}),new de(/total ([^,]+), reused ([^,]+), pack-reused (\d+)/i,(e,[t,r,s])=>{let n=fr(e.remoteMessages);n.total=Bs(t),n.reused=Bs(r),n.packReused=E(s)})]}});function wi(e,t){return Q({remoteMessages:new bi},yi,t)}var yi,bi,_i=l({"src/lib/parsers/parse-remote-messages.ts"(){w(),ju(),yi=[new de(/^remote:\s*(.+)$/,(e,[t])=>(e.remoteMessages.all.push(t.trim()),!1)),...vi,new de([/create a (?:pull|merge) request/i,/\s(https?:\/\/\S+)$/],(e,[t])=>{e.remoteMessages.pullRequestUrl=t}),new de([/found (\d+) vulnerabilities.+\(([^)]+)\)/i,/\s(https?:\/\/\S+)$/],(e,[t,r,s])=>{e.remoteMessages.vulnerabilities={count:E(t),summary:r,url:s}})],bi=class{constructor(){this.all=[]}}}});function Wu(e,t){let r=Q(new hi,ki,[e,t]);return r.message&&r}var Us,Gs,js,Ws,ki,Vs,qr,Ci=l({"src/lib/parsers/parse-pull.ts"(){Gu(),w(),_i(),Us=/^\s*(.+?)\s+\|\s+\d+\s*(\+*)(-*)/,Gs=/(\d+)\D+((\d+)\D+\(\+\))?(\D+(\d+)\D+\(-\))?/,js=/^(create|delete) mode \d+ (.+)/,Ws=[new y(Us,(e,[t,r,s])=>{e.files.push(t),r&&(e.insertions[t]=r.length),s&&(e.deletions[t]=s.length)}),new y(Gs,(e,[t,,r,,s])=>r!==void 0||s!==void 0?(e.summary.changes=+t||0,e.summary.insertions=+r||0,e.summary.deletions=+s||0,!0):!1),new y(js,(e,[t,r])=>{k(e.files,r),k(t==="create"?e.created:e.deleted,r)})],ki=[new y(/^from\s(.+)$/i,(e,[t])=>void(e.remote=t)),new y(/^fatal:\s(.+)$/,(e,[t])=>void(e.message=t)),new y(/([a-z0-9]+)\.\.([a-z0-9]+)\s+(\S+)\s+->\s+(\S+)$/,(e,[t,r,s,n])=>{e.branch.local=s,e.hash.local=t,e.branch.remote=n,e.hash.remote=r})],Vs=(e,t)=>Q(new kr,Ws,[e,t]),qr=(e,t)=>Object.assign(new kr,Vs(e,t),wi(e,t))}}),Ks,Ti,qs,Vu=l({"src/lib/parsers/parse-merge.ts"(){Uu(),w(),Ci(),Ks=[new y(/^Auto-merging\s+(.+)$/,(e,[t])=>{e.merges.push(t)}),new y(/^CONFLICT\s+\((.+)\): Merge conflict in (.+)$/,(e,[t,r])=>{e.conflicts.push(new kt(t,r))}),new y(/^CONFLICT\s+\((.+\/delete)\): (.+) deleted in (.+) and/,(e,[t,r,s])=>{e.conflicts.push(new kt(t,r,{deleteRef:s}))}),new y(/^CONFLICT\s+\((.+)\):/,(e,[t])=>{e.conflicts.push(new kt(t,null))}),new y(/^Automatic merge failed;\s+(.+)$/,(e,[t])=>{e.result=t})],Ti=(e,t)=>Object.assign(qs(e,t),qr(e,t)),qs=e=>Q(new gi,Ks,e)}});function zs(e){return e.length?{commands:["merge",...e],format:"utf-8",parser(t,r){let s=Ti(t,r);if(s.failed)throw new He(s);return s}}:j("Git.merge requires at least one option")}var Ku=l({"src/lib/tasks/merge.ts"(){Me(),Vu(),O()}});function qu(e,t,r){let s=r.includes("deleted"),n=r.includes("tag")||/^refs\/tags/.test(e),i=!r.includes("new");return{deleted:s,tag:n,branch:!n,new:!i,alreadyUpdated:i,local:e,remote:t}}var Qs,Ei,Ys,zu=l({"src/lib/parsers/parse-push.ts"(){w(),_i(),Qs=[new y(/^Pushing to (.+)$/,(e,[t])=>{e.repo=t}),new y(/^updating local tracking ref '(.+)'/,(e,[t])=>{e.ref=Ke(H({},e.ref||{}),{local:t})}),new y(/^[=*-]\s+([^:]+):(\S+)\s+\[(.+)]$/,(e,[t,r,s])=>{e.pushed.push(qu(t,r,s))}),new y(/^Branch '([^']+)' set up to track remote branch '([^']+)' from '([^']+)'/,(e,[t,r,s])=>{e.branch=Ke(H({},e.branch||{}),{local:t,remote:r,remoteName:s})}),new y(/^([^:]+):(\S+)\s+([a-z0-9]+)\.\.([a-z0-9]+)$/,(e,[t,r,s,n])=>{e.update={head:{local:t,remote:r},hash:{from:s,to:n}}})],Ei=(e,t)=>{let r=Ys(e,t),s=wi(e,t);return H(H({},r),s)},Ys=(e,t)=>Q({pushed:[]},Qs,[e,t])}}),Pi={};x(Pi,{pushTagsTask:()=>Qu,pushTask:()=>zr});function Qu(e={},t){return k(t,"--tags"),zr(e,t)}function zr(e={},t){let r=["push",...t];return e.branch&&r.splice(1,0,e.branch),e.remote&&r.splice(1,0,e.remote),Ot(r,"-v"),k(r,"--verbose"),k(r,"--porcelain"),{commands:r,format:"utf-8",parser:Ei}}var Si=l({"src/lib/tasks/push.ts"(){zu(),w()}});function Yu(){return{showBuffer(){let e=["show",...G(arguments,1)];return e.includes("--binary")||e.splice(1,0,"--binary"),this._runTask(Nn(e),R(arguments))},show(){let e=["show",...G(arguments,1)];return this._runTask(B(e),R(arguments))}}}var Hu=l({"src/lib/tasks/show.ts"(){w(),O()}}),Hs,Ii,Ju=l({"src/lib/responses/FileStatusSummary.ts"(){Hs=/^(.+) -> (.+)$/,Ii=class{constructor(e,t,r){if(this.path=e,this.index=t,this.working_dir=r,t+r==="R"){let s=Hs.exec(e)||[null,e,e];this.from=s[1]||"",this.path=s[2]||""}}}}});function Js(e){let[t,r]=e.split(Le);return{from:r||t,to:t}}function z(e,t,r){return[`${e}${t}`,r]}function mr(e,...t){return t.map(r=>z(e,r,(s,n)=>k(s.conflicted,n)))}function Xu(e,t){let r=t.trim();switch(" "){case r.charAt(2):return s(r.charAt(0),r.charAt(1),r.substr(3));case r.charAt(1):return s(" ",r.charAt(0),r.substr(2));default:return}function s(n,i,a){let o=`${n}${i}`,d=Ri.get(o);d&&d(e,a),o!=="##"&&o!=="!!"&&e.files.push(new Ii(a.replace(/\0.+$/,""),n,i))}}var Xs,Ri,Oi,Zu=l({"src/lib/responses/StatusSummary.ts"(){w(),Ju(),Xs=class{constructor(){this.not_added=[],this.conflicted=[],this.created=[],this.deleted=[],this.ignored=void 0,this.modified=[],this.renamed=[],this.files=[],this.staged=[],this.ahead=0,this.behind=0,this.current=null,this.tracking=null,this.detached=!1,this.isClean=()=>!this.files.length}},Ri=new Map([z(" ","A",(e,t)=>k(e.created,t)),z(" ","D",(e,t)=>k(e.deleted,t)),z(" ","M",(e,t)=>k(e.modified,t)),z("A"," ",(e,t)=>k(e.created,t)&&k(e.staged,t)),z("A","M",(e,t)=>k(e.created,t)&&k(e.staged,t)&&k(e.modified,t)),z("D"," ",(e,t)=>k(e.deleted,t)&&k(e.staged,t)),z("M"," ",(e,t)=>k(e.modified,t)&&k(e.staged,t)),z("M","M",(e,t)=>k(e.modified,t)&&k(e.staged,t)),z("R"," ",(e,t)=>{k(e.renamed,Js(t))}),z("R","M",(e,t)=>{let r=Js(t);k(e.renamed,r),k(e.modified,r.to)}),z("!","!",(e,t)=>{k(e.ignored=e.ignored||[],t)}),z("?","?",(e,t)=>k(e.not_added,t)),...mr("A","A","U"),...mr("D","D","U"),...mr("U","A","D","U"),["##",(e,t)=>{let r=/ahead (\d+)/,s=/behind (\d+)/,n=/^(.+?(?=(?:\.{3}|\s|$)))/,i=/\.{3}(\S*)/,a=/\son\s([\S]+)$/,o;o=r.exec(t),e.ahead=o&&+o[1]||0,o=s.exec(t),e.behind=o&&+o[1]||0,o=n.exec(t),e.current=o&&o[1],o=i.exec(t),e.tracking=o&&o[1],o=a.exec(t),e.current=o&&o[1]||e.current,e.detached=/\(no branch\)/.test(t)}]]),Oi=function(e){let t=e.split(Le),r=new Xs;for(let s=0,n=t.length;s<n;){let i=t[s++].trim();i&&(i.charAt(0)==="R"&&(i+=Le+(t[s++]||"")),Xu(r,i))}return r}}});function ec(e){return{format:"utf-8",commands:["status","--porcelain","-b","-u","--null",...e.filter(r=>!xi.includes(r))],parser(r){return Oi(r)}}}var xi,tc=l({"src/lib/tasks/status.ts"(){Zu(),xi=["--null","-z"]}});function Pt(e=0,t=0,r=0,s="",n=!0){return Object.defineProperty({major:e,minor:t,patch:r,agent:s,installed:n},"toString",{value(){return`${this.major}.${this.minor}.${this.patch}`},configurable:!1,enumerable:!1})}function rc(){return Pt(0,0,0,"",!1)}function sc(){return{version(){return this._runTask({commands:["--version"],format:"utf-8",parser:nc,onError(e,t,r,s){if(e.exitCode===-2)return r(Buffer.from(Qr));s(t)}})}}}function nc(e){return e===Qr?rc():Q(Pt(0,0,0,e),Ai,e)}var Qr,Ai,ic=l({"src/lib/tasks/version.ts"(){w(),Qr="installed=false",Ai=[new y(/version (\d+)\.(\d+)\.(\d+)(?:\s*\((.+)\))?/,(e,[t,r,s,n=""])=>{Object.assign(e,Pt(E(t),E(r),E(s),n))}),new y(/version (\d+)\.(\d+)\.(\D+)(.+)?$/,(e,[t,r,s,n=""])=>{Object.assign(e,Pt(E(t),E(r),s,n))})]}}),Fi={};x(Fi,{SimpleGitApi:()=>Cr});var Cr,oc=l({"src/lib/simple-git-api.ts"(){pu(),gu(),vu(),ku(),jn(),Tu(),zn(),Pu(),xu(),pi(),Ku(),Si(),Hu(),tc(),O(),ic(),w(),Cr=class{constructor(e){this._executor=e}_runTask(e,t){let r=this._executor.chain(),s=r.push(e);return t&&mu(e,s,t),Object.create(this,{then:{value:s.then.bind(s)},catch:{value:s.catch.bind(s)},_executor:{value:r}})}add(e){return this._runTask(B(["add",...pe(e)]),R(arguments))}cwd(e){let t=R(arguments);return typeof e=="string"?this._runTask(Ls(e,this._executor),t):typeof e?.path=="string"?this._runTask(Ls(e.path,e.root&&this._executor||void 0),t):this._runTask(j("Git.cwd: workingDirectory must be supplied as a string"),t)}hashObject(e,t){return this._runTask(Eu(e,t===!0),R(arguments))}init(e){return this._runTask(Ou(e===!0,this._executor.cwd,G(arguments)),R(arguments))}merge(){return this._runTask(zs(G(arguments)),R(arguments))}mergeFromTo(e,t){return L(e)&&L(t)?this._runTask(zs([e,t,...G(arguments)]),R(arguments,!1)):this._runTask(j("Git.mergeFromTo requires that the 'remote' and 'branch' arguments are supplied as strings"))}outputHandler(e){return this._executor.outputHandler=e,this}push(){let e=zr({remote:se(arguments[0],L),branch:se(arguments[1],L)},G(arguments));return this._runTask(e,R(arguments))}stash(){return this._runTask(B(["stash",...G(arguments)]),R(arguments))}status(){return this._runTask(ec(G(arguments)),R(arguments))}},Object.assign(Cr.prototype,hu(),_u(),Za(),Cu(),su(),Bu(),Yu(),sc())}}),Ni={};x(Ni,{Scheduler:()=>Mi});var Zs,Mi,ac=l({"src/lib/runners/scheduler.ts"(){w(),Xn(),Zs=(()=>{let e=0;return()=>{e++;let{promise:t,done:r}=(0,Li.createDeferred)();return{promise:t,done:r,id:e}}})(),Mi=class{constructor(e=2){this.concurrency=e,this.logger=$r("","scheduler"),this.pending=[],this.running=[],this.logger("Constructed, concurrency=%s",e)}schedule(){if(!this.pending.length||this.running.length>=this.concurrency){this.logger("Schedule attempt ignored, pending=%s running=%s concurrency=%s",this.pending.length,this.running.length,this.concurrency);return}let e=k(this.running,this.pending.shift());this.logger("Attempting id=%s",e.id),e.done(()=>{this.logger("Completing id=",e.id),Ot(this.running,e),this.schedule()})}next(){let{promise:e,id:t}=k(this.pending,Zs());return this.logger("Scheduling id=%s",t),this.schedule(),e}}}}),Di={};x(Di,{applyPatchTask:()=>uc});function uc(e,t){return B(["apply",...t,...e])}var cc=l({"src/lib/tasks/apply-patch.ts"(){O()}});function lc(e,t){return{branch:e,hash:t,success:!0}}function fc(e){return{branch:e,hash:null,success:!1}}var $i,mc=l({"src/lib/responses/BranchDeleteSummary.ts"(){$i=class{constructor(){this.all=[],this.branches={},this.errors=[]}get success(){return!this.errors.length}}}});function Bi(e,t){return t===1&&Tr.test(e)}var en,Tr,tn,Lt,dc=l({"src/lib/parsers/parse-branch-delete.ts"(){mc(),w(),en=/(\S+)\s+\(\S+\s([^)]+)\)/,Tr=/^error[^']+'([^']+)'/m,tn=[new y(en,(e,[t,r])=>{let s=lc(t,r);e.all.push(s),e.branches[t]=s}),new y(Tr,(e,[t])=>{let r=fc(t);e.errors.push(r),e.all.push(r),e.branches[t]=r})],Lt=(e,t)=>Q(new $i,tn,[e,t])}}),Ui,pc=l({"src/lib/responses/BranchSummary.ts"(){Ui=class{constructor(){this.all=[],this.branches={},this.current="",this.detached=!1}push(e,t,r,s,n){e==="*"&&(this.detached=t,this.current=r),this.all.push(r),this.branches[r]={current:e==="*",linkedWorkTree:e==="+",name:r,commit:s,label:n}}}}});function rn(e){return e?e.charAt(0):""}function Gi(e){return Q(new Ui,ji,e)}var ji,gc=l({"src/lib/parsers/parse-branch.ts"(){pc(),w(),ji=[new y(/^([*+]\s)?\((?:HEAD )?detached (?:from|at) (\S+)\)\s+([a-z0-9]+)\s(.*)$/,(e,[t,r,s,n])=>{e.push(rn(t),!0,r,s,n)}),new y(/^([*+]\s)?(\S+)\s+([a-z0-9]+)\s?(.*)$/s,(e,[t,r,s,n])=>{e.push(rn(t),!1,r,s,n)})]}}),Wi={};x(Wi,{branchLocalTask:()=>vc,branchTask:()=>hc,containsDeleteBranchCommand:()=>Vi,deleteBranchTask:()=>yc,deleteBranchesTask:()=>wc});function Vi(e){let t=["-d","-D","--delete"];return e.some(r=>t.includes(r))}function hc(e){let t=Vi(e),r=["branch",...e];return r.length===1&&r.push("-a"),r.includes("-v")||r.splice(1,0,"-v"),{format:"utf-8",commands:r,parser(s,n){return t?Lt(s,n).all[0]:Gi(s)}}}function vc(){return{format:"utf-8",commands:["branch","-v"],parser:Gi}}function wc(e,t=!1){return{format:"utf-8",commands:["branch","-v",t?"-D":"-d",...e],parser(r,s){return Lt(r,s)},onError({exitCode:r,stdOut:s},n,i,a){if(!Bi(String(n),r))return a(n);i(s)}}}function yc(e,t=!1){let r={format:"utf-8",commands:["branch","-v",t?"-D":"-d",e],parser(s,n){return Lt(s,n).branches[e]},onError({exitCode:s,stdErr:n,stdOut:i},a,o,d){if(!Bi(String(a),s))return d(a);throw new He(r.parser(ze(i),ze(n)),String(a))}};return r}var bc=l({"src/lib/tasks/branch.ts"(){Me(),dc(),gc(),w()}}),Ki,_c=l({"src/lib/responses/CheckIgnore.ts"(){Ki=e=>e.split(/\n/g).map(t=>t.trim()).filter(t=>!!t)}}),qi={};x(qi,{checkIgnoreTask:()=>kc});function kc(e){return{commands:["check-ignore",...e],format:"utf-8",parser:Ki}}var Cc=l({"src/lib/tasks/check-ignore.ts"(){_c()}}),zi={};x(zi,{cloneMirrorTask:()=>Ec,cloneTask:()=>Qi});function Tc(e){return/^--upload-pack(=|$)/.test(e)}function Qi(e,t,r){let s=["clone",...r];return L(e)&&s.push(e),L(t)&&s.push(t),s.find(Tc)?j("git.fetch: potential exploit argument blocked."):B(s)}function Ec(e,t,r){return k(r,"--mirror"),Qi(e,t,r)}var Pc=l({"src/lib/tasks/clone.ts"(){O(),w()}});function Sc(e,t){return Q({raw:e,remote:null,branches:[],tags:[],updated:[],deleted:[]},Yi,[e,t])}var Yi,Ic=l({"src/lib/parsers/parse-fetch.ts"(){w(),Yi=[new y(/From (.+)$/,(e,[t])=>{e.remote=t}),new y(/\* \[new branch]\s+(\S+)\s*-> (.+)$/,(e,[t,r])=>{e.branches.push({name:t,tracking:r})}),new y(/\* \[new tag]\s+(\S+)\s*-> (.+)$/,(e,[t,r])=>{e.tags.push({name:t,tracking:r})}),new y(/- \[deleted]\s+\S+\s*-> (.+)$/,(e,[t])=>{e.deleted.push({tracking:t})}),new y(/\s*([^.]+)\.\.(\S+)\s+(\S+)\s*-> (.+)$/,(e,[t,r,s,n])=>{e.updated.push({name:s,tracking:n,to:r,from:t})})]}}),Hi={};x(Hi,{fetchTask:()=>Oc});function Rc(e){return/^--upload-pack(=|$)/.test(e)}function Oc(e,t,r){let s=["fetch",...r];return e&&t&&s.push(e,t),s.find(Rc)?j("git.fetch: potential exploit argument blocked."):{commands:s,format:"utf-8",parser:Sc}}var xc=l({"src/lib/tasks/fetch.ts"(){Ic(),O()}});function Ac(e){return Q({moves:[]},Ji,e)}var Ji,Fc=l({"src/lib/parsers/parse-move.ts"(){w(),Ji=[new y(/^Renaming (.+) to (.+)$/,(e,[t,r])=>{e.moves.push({from:t,to:r})})]}}),Xi={};x(Xi,{moveTask:()=>Nc});function Nc(e,t){return{commands:["mv","-v",...pe(e),t],format:"utf-8",parser:Ac}}var Lc=l({"src/lib/tasks/move.ts"(){Fc(),w()}}),Zi={};x(Zi,{pullTask:()=>Mc});function Mc(e,t,r){let s=["pull",...r];return e&&t&&s.splice(1,0,e,t),{commands:s,format:"utf-8",parser(n,i){return qr(n,i)},onError(n,i,a,o){let d=Wu(ze(n.stdOut),ze(n.stdErr));if(d)return o(new He(d));o(i)}}}var Dc=l({"src/lib/tasks/pull.ts"(){Me(),Ci(),w()}});function $c(e){let t={};return eo(e,([r])=>t[r]={name:r}),Object.values(t)}function Bc(e){let t={};return eo(e,([r,s,n])=>{t.hasOwnProperty(r)||(t[r]={name:r,refs:{fetch:"",push:""}}),n&&s&&(t[r].refs[n.replace(/[^a-z]/g,"")]=s)}),Object.values(t)}function eo(e,t){Pr(e,r=>t(r.split(/\s+/)))}var Uc=l({"src/lib/responses/GetRemoteSummary.ts"(){w()}}),to={};x(to,{addRemoteTask:()=>Gc,getRemotesTask:()=>jc,listRemotesTask:()=>Wc,remoteTask:()=>Vc,removeRemoteTask:()=>Kc});function Gc(e,t,r=[]){return B(["remote","add",...r,e,t])}function jc(e){let t=["remote"];return e&&t.push("-v"),{commands:t,format:"utf-8",parser:e?Bc:$c}}function Wc(e=[]){let t=[...e];return t[0]!=="ls-remote"&&t.unshift("ls-remote"),B(t)}function Vc(e=[]){let t=[...e];return t[0]!=="remote"&&t.unshift("remote"),B(t)}function Kc(e){return B(["remote","remove",e])}var qc=l({"src/lib/tasks/remote.ts"(){Uc(),O()}}),ro={};x(ro,{stashListTask:()=>zc});function zc(e={},t){let r=di(e),s=["stash","list",...r.commands,...t],n=ci(r.splitter,r.fields,Ur(s));return Nt(s)||{commands:s,format:"utf-8",parser:n}}var Qc=l({"src/lib/tasks/stash-list.ts"(){et(),fi(),Kr(),pi()}}),so={};x(so,{addSubModuleTask:()=>Yc,initSubModuleTask:()=>Hc,subModuleTask:()=>Mt,updateSubModuleTask:()=>Jc});function Yc(e,t){return Mt(["add",e,t])}function Hc(e){return Mt(["init",...e])}function Mt(e){let t=[...e];return t[0]!=="submodule"&&t.unshift("submodule"),B(t)}function Jc(e){return Mt(["update",...e])}var Xc=l({"src/lib/tasks/sub-module.ts"(){O()}});function Zc(e,t){let r=isNaN(e),s=isNaN(t);return r!==s?r?1:-1:r?no(e,t):0}function no(e,t){return e===t?0:e>t?1:-1}function el(e){return e.trim()}function wt(e){return typeof e=="string"&&parseInt(e.replace(/^\D+/g,""),10)||0}var sn,io,tl=l({"src/lib/responses/TagList.ts"(){sn=class{constructor(e,t){this.all=e,this.latest=t}},io=function(e,t=!1){let r=e.split(`
`).map(el).filter(Boolean);t||r.sort(function(n,i){let a=n.split("."),o=i.split(".");if(a.length===1||o.length===1)return Zc(wt(a[0]),wt(o[0]));for(let d=0,p=Math.max(a.length,o.length);d<p;d++){let c=no(wt(a[d]),wt(o[d]));if(c)return c}return 0});let s=t?r[0]:[...r].reverse().find(n=>n.indexOf(".")>=0);return new sn(r,s)}}}),oo={};x(oo,{addAnnotatedTagTask:()=>nl,addTagTask:()=>sl,tagListTask:()=>rl});function rl(e=[]){let t=e.some(r=>/^--sort=/.test(r));return{format:"utf-8",commands:["tag","-l",...e],parser(r){return io(r,t)}}}function sl(e){return{format:"utf-8",commands:["tag",e],parser(){return{name:e}}}}function nl(e,t){return{format:"utf-8",commands:["tag","-a","-m",t,e],parser(){return{name:e}}}}var il=l({"src/lib/tasks/tag.ts"(){tl()}}),ol=Pa({"src/git.js"(e,t){var{GitExecutor:r}=(fu(),I(ei)),{SimpleGitApi:s}=(oc(),I(Fi)),{Scheduler:n}=(ac(),I(Ni)),{configurationErrorTask:i}=(O(),I(vr)),{asArray:a,filterArray:o,filterPrimitives:d,filterString:p,filterStringOrStringArray:c,filterType:f,getTrailingOptions:m,trailingFunctionArgument:g,trailingOptionsArgument:C}=(w(),I(Tn)),{applyPatchTask:M}=(cc(),I(Di)),{branchTask:S,branchLocalTask:W,deleteBranchesTask:le,deleteBranchTask:zt}=(bc(),I(Wi)),{checkIgnoreTask:Te}=(Cc(),I(qi)),{checkIsRepoTask:Jr}=(In(),I(En)),{cloneTask:Ue,cloneMirrorTask:Qt}=(Pc(),I(zi)),{cleanWithOptionsTask:rt,isCleanOptionsArray:Yt}=(Bn(),I(Dn)),{diffSummaryTask:mo}=(Kr(),I(mi)),{fetchTask:po}=(xc(),I(Hi)),{moveTask:go}=(Lc(),I(Xi)),{pullTask:ho}=(Dc(),I(Zi)),{pushTagsTask:vo}=(Si(),I(Pi)),{addRemoteTask:wo,getRemotesTask:yo,listRemotesTask:bo,remoteTask:_o,removeRemoteTask:ko}=(qc(),I(to)),{getResetMode:Co,resetTask:To}=(Jn(),I(Qn)),{stashListTask:Eo}=(Qc(),I(ro)),{addSubModuleTask:Po,initSubModuleTask:So,subModuleTask:Io,updateSubModuleTask:Ro}=(Xc(),I(so)),{addAnnotatedTagTask:Oo,addTagTask:xo,tagListTask:Ao}=(il(),I(oo)),{straightThroughBufferTask:Fo,straightThroughStringTask:te}=(O(),I(vr));function v(u,h){this._executor=new r(u.binary,u.baseDir,new n(u.maxConcurrentProcesses),h),this._trimmed=u.trimmed}(v.prototype=Object.create(s.prototype)).constructor=v,v.prototype.customBinary=function(u){return this._executor.binary=u,this},v.prototype.env=function(u,h){return arguments.length===1&&typeof u=="object"?this._executor.env=u:(this._executor.env=this._executor.env||{})[u]=h,this},v.prototype.stashList=function(u){return this._runTask(Eo(C(arguments)||{},o(u)&&u||[]),g(arguments))};function Xr(u,h,T,D){return typeof T!="string"?i(`git.${u}() requires a string 'repoPath'`):h(T,f(D,p),m(arguments))}v.prototype.clone=function(){return this._runTask(Xr("clone",Ue,...arguments),g(arguments))},v.prototype.mirror=function(){return this._runTask(Xr("mirror",Qt,...arguments),g(arguments))},v.prototype.mv=function(u,h){return this._runTask(go(u,h),g(arguments))},v.prototype.checkoutLatestTag=function(u){var h=this;return this.pull(function(){h.tags(function(T,D){h.checkout(D.latest,u)})})},v.prototype.pull=function(u,h,T,D){return this._runTask(ho(f(u,p),f(h,p),m(arguments)),g(arguments))},v.prototype.fetch=function(u,h){return this._runTask(po(f(u,p),f(h,p),m(arguments)),g(arguments))},v.prototype.silent=function(u){return console.warn("simple-git deprecation notice: git.silent: logging should be configured using the `debug` library / `DEBUG` environment variable, this will be an error in version 3"),this},v.prototype.tags=function(u,h){return this._runTask(Ao(m(arguments)),g(arguments))},v.prototype.rebase=function(){return this._runTask(te(["rebase",...m(arguments)]),g(arguments))},v.prototype.reset=function(u){return this._runTask(To(Co(u),m(arguments)),g(arguments))},v.prototype.revert=function(u){let h=g(arguments);return typeof u!="string"?this._runTask(i("Commit must be a string"),h):this._runTask(te(["revert",...m(arguments,0,!0),u]),h)},v.prototype.addTag=function(u){let h=typeof u=="string"?xo(u):i("Git.addTag requires a tag name");return this._runTask(h,g(arguments))},v.prototype.addAnnotatedTag=function(u,h){return this._runTask(Oo(u,h),g(arguments))},v.prototype.deleteLocalBranch=function(u,h,T){return this._runTask(zt(u,typeof h=="boolean"?h:!1),g(arguments))},v.prototype.deleteLocalBranches=function(u,h,T){return this._runTask(le(u,typeof h=="boolean"?h:!1),g(arguments))},v.prototype.branch=function(u,h){return this._runTask(S(m(arguments)),g(arguments))},v.prototype.branchLocal=function(u){return this._runTask(W(),g(arguments))},v.prototype.raw=function(u){let h=!Array.isArray(u),T=[].slice.call(h?arguments:u,0);for(let J=0;J<T.length&&h;J++)if(!d(T[J])){T.splice(J,T.length-J);break}T.push(...m(arguments,0,!0));var D=g(arguments);return T.length?this._runTask(te(T,this._trimmed),D):this._runTask(i("Raw: must supply one or more command to execute"),D)},v.prototype.submoduleAdd=function(u,h,T){return this._runTask(Po(u,h),g(arguments))},v.prototype.submoduleUpdate=function(u,h){return this._runTask(Ro(m(arguments,!0)),g(arguments))},v.prototype.submoduleInit=function(u,h){return this._runTask(So(m(arguments,!0)),g(arguments))},v.prototype.subModule=function(u,h){return this._runTask(Io(m(arguments)),g(arguments))},v.prototype.listRemote=function(){return this._runTask(bo(m(arguments)),g(arguments))},v.prototype.addRemote=function(u,h,T){return this._runTask(wo(u,h,m(arguments)),g(arguments))},v.prototype.removeRemote=function(u,h){return this._runTask(ko(u),g(arguments))},v.prototype.getRemotes=function(u,h){return this._runTask(yo(u===!0),g(arguments))},v.prototype.remote=function(u,h){return this._runTask(_o(m(arguments)),g(arguments))},v.prototype.tag=function(u,h){let T=m(arguments);return T[0]!=="tag"&&T.unshift("tag"),this._runTask(te(T),g(arguments))},v.prototype.updateServerInfo=function(u){return this._runTask(te(["update-server-info"]),g(arguments))},v.prototype.pushTags=function(u,h){let T=vo({remote:f(u,p)},m(arguments));return this._runTask(T,g(arguments))},v.prototype.rm=function(u){return this._runTask(te(["rm","-f",...a(u)]),g(arguments))},v.prototype.rmKeepLocal=function(u){return this._runTask(te(["rm","--cached",...a(u)]),g(arguments))},v.prototype.catFile=function(u,h){return this._catFile("utf-8",arguments)},v.prototype.binaryCatFile=function(){return this._catFile("buffer",arguments)},v.prototype._catFile=function(u,h){var T=g(h),D=["cat-file"],J=h[0];if(typeof J=="string")return this._runTask(i("Git.catFile: options must be supplied as an array of strings"),T);Array.isArray(J)&&D.push.apply(D,J);let Ht=u==="buffer"?Fo(D):te(D);return this._runTask(Ht,T)},v.prototype.diff=function(u,h){let T=p(u)?i("git.diff: supplying options as a single string is no longer supported, switch to an array of strings"):te(["diff",...m(arguments)]);return this._runTask(T,g(arguments))},v.prototype.diffSummary=function(){return this._runTask(mo(m(arguments,1)),g(arguments))},v.prototype.applyPatch=function(u){let h=c(u)?M(a(u),m([].slice.call(arguments,1))):i("git.applyPatch requires one or more string patches as the first argument");return this._runTask(h,g(arguments))},v.prototype.revparse=function(){let u=["rev-parse",...m(arguments,!0)];return this._runTask(te(u,!0),g(arguments))},v.prototype.clean=function(u,h,T){let D=Yt(u),J=D&&u.join("")||f(u,p)||"",Ht=m([].slice.call(arguments,D?1:0));return this._runTask(rt(J,Ht),g(arguments))},v.prototype.exec=function(u){let h={commands:[],format:"utf-8",parser(){typeof u=="function"&&u()}};return this._runTask(h)},v.prototype.clearQueue=function(){return this},v.prototype.checkIgnore=function(u,h){return this._runTask(Te(a(f(u,c,[]))),g(arguments))},v.prototype.checkIsRepo=function(u,h){return this._runTask(Jr(f(u,p)),g(arguments))},t.exports=v}});Ye();ge();var al=class extends ue{constructor(e,t){super(void 0,t),this.config=e}};ge();ge();var be=class extends ue{constructor(e,t,r){super(e,r),this.task=e,this.plugin=t,Object.setPrototypeOf(this,new.target.prototype)}};Me();cn();In();Bn();jn();Vn();zn();Jn();function ul(e){return e?[{type:"spawn.before",action(s,n){e.aborted&&n.kill(new be(void 0,"abort","Abort already signaled"))}},{type:"spawn.after",action(s,n){function i(){n.kill(new be(void 0,"abort","Abort signal received"))}e.addEventListener("abort",i),n.spawned.on("close",()=>e.removeEventListener("abort",i))}}]:void 0}function cl(e){return typeof e=="string"&&e.trim().toLowerCase()==="-c"}function ll(e,t){if(cl(e)&&/^\s*protocol(.[a-z]+)?.allow/.test(t))throw new be(void 0,"unsafe","Configuring protocol.allow is not permitted without enabling allowUnsafeExtProtocol")}function fl(e,t){if(/^\s*--(upload|receive)-pack/.test(e))throw new be(void 0,"unsafe","Use of --upload-pack or --receive-pack is not permitted without enabling allowUnsafePack");if(t==="clone"&&/^\s*-u\b/.test(e))throw new be(void 0,"unsafe","Use of clone with option -u is not permitted without enabling allowUnsafePack");if(t==="push"&&/^\s*--exec\b/.test(e))throw new be(void 0,"unsafe","Use of push with option --exec is not permitted without enabling allowUnsafePack")}function ml({allowUnsafeProtocolOverride:e=!1,allowUnsafePack:t=!1}={}){return{type:"spawn.args",action(r,s){return r.forEach((n,i)=>{let a=i<r.length?r[i+1]:"";e||ll(n,a),t||fl(n,s.method)}),r}}}w();function dl(e){let t=qe(e,"-c");return{type:"spawn.args",action(r){return[...t,...r]}}}w();var nn=(0,Ne.deferred)().promise;function pl({onClose:e=!0,onExit:t=50}={}){function r(){let n=-1,i={close:(0,Ne.deferred)(),closeTimeout:(0,Ne.deferred)(),exit:(0,Ne.deferred)(),exitTimeout:(0,Ne.deferred)()},a=Promise.race([e===!1?nn:i.closeTimeout.promise,t===!1?nn:i.exitTimeout.promise]);return s(e,i.close,i.closeTimeout),s(t,i.exit,i.exitTimeout),{close(o){n=o,i.close.done()},exit(o){n=o,i.exit.done()},get exitCode(){return n},result:a}}function s(n,i,a){n!==!1&&(n===!0?i.promise:i.promise.then(()=>dr(n))).then(a.done)}return{type:"spawn.after",action(n,i){return Ve(this,arguments,function*(a,{spawned:o,close:d}){var p,c;let f=r(),m=!0,g=()=>void(m=!1);(p=o.stdout)==null||p.on("data",g),(c=o.stderr)==null||c.on("data",g),o.on("error",g),o.on("close",C=>f.close(C)),o.on("exit",C=>f.exit(C));try{yield f.result,m&&(yield dr(50)),d(f.exitCode)}catch(C){d(f.exitCode,C)}})}}}ge();function gl(e){return!!(e.exitCode&&e.stdErr.length)}function hl(e){return Buffer.concat([...e.stdOut,...e.stdErr])}function vl(e=!1,t=gl,r=hl){return(s,n)=>!e&&s||!t(n)?s:r(n)}function on(e){return{type:"task.error",action(t,r){let s=e(t.error,{stdErr:r.stdErr,stdOut:r.stdOut,exitCode:r.exitCode});return Buffer.isBuffer(s)?{error:new ue(void 0,s.toString("utf-8"))}:{error:s}}}}w();var wl=class{constructor(){this.plugins=new Set}add(e){let t=[];return pe(e).forEach(r=>r&&this.plugins.add(k(t,r))),()=>{t.forEach(r=>this.plugins.delete(r))}}exec(e,t,r){let s=t,n=Object.freeze(Object.create(r));for(let i of this.plugins)i.type===e&&(s=i.action(s,n));return s}};w();function yl(e){let t="--progress",r=["checkout","clone","fetch","pull","push"];return[{type:"spawn.args",action(i,a){return r.includes(a.method)?gn(i,t):i}},{type:"spawn.after",action(i,a){var o;a.commands.includes(t)&&((o=a.spawned.stderr)==null||o.on("data",d=>{let p=/^([\s\S]+?):\s*(\d+)% \((\d+)\/(\d+)\)/.exec(d.toString("utf8"));p&&e({method:a.method,stage:bl(p[1]),progress:E(p[2]),processed:E(p[3]),total:E(p[4])})}))}}]}function bl(e){return String(e.toLowerCase().split(" ",1))||"unknown"}w();function _l(e){let t=vn(e,["uid","gid"]);return{type:"spawn.options",action(r){return H(H({},t),r)}}}function kl({block:e,stdErr:t=!0,stdOut:r=!0}){if(e>0)return{type:"spawn.after",action(s,n){var i,a;let o;function d(){o&&clearTimeout(o),o=setTimeout(c,e)}function p(){var f,m;(f=n.spawned.stdout)==null||f.off("data",d),(m=n.spawned.stderr)==null||m.off("data",d),n.spawned.off("exit",p),n.spawned.off("close",p),o&&clearTimeout(o)}function c(){p(),n.kill(new be(void 0,"timeout","block timeout reached"))}r&&((i=n.spawned.stdout)==null||i.on("data",d)),t&&((a=n.spawned.stderr)==null||a.on("data",d)),n.spawned.on("exit",p),n.spawned.on("close",p),d()}}}Ye();function Cl(){return{type:"spawn.args",action(e){let t=[],r;function s(n){(r=r||[]).push(...n)}for(let n=0;n<e.length;n++){let i=e[n];if(Ct(i)){s(xs(i));continue}if(i==="--"){s(e.slice(n+1).flatMap(a=>Ct(a)&&xs(a)||a));break}t.push(i)}return r?[...t,"--",...r.map(String)]:t}}}w();var Tl=ol();function El(e,t){let r=new wl,s=kn(e&&(typeof e=="string"?{baseDir:e}:e)||{},t);if(!Sr(s.baseDir))throw new al(s,"Cannot use simple-git on a directory that does not exist");return Array.isArray(s.config)&&r.add(dl(s.config)),r.add(ml(s.unsafe)),r.add(Cl()),r.add(pl(s.completion)),s.abort&&r.add(ul(s.abort)),s.progress&&r.add(yl(s.progress)),s.timeout&&r.add(kl(s.timeout)),s.spawnOptions&&r.add(_l(s.spawnOptions)),r.add(on(vl(!0))),s.errors&&r.add(on(s.errors)),new Tl(s,r)}Me();var Dt=El;var U=$(require("vscode"));async function uo(){let e=U.window.activeTextEditor,t;if(!U.workspace.workspaceFolders)return{result:void 0,message:V.NOT_A_VALID_REPO};if(U.workspace.workspaceFolders.length===0)return{result:void 0,message:"No workspace folder found."};if(e){let r=e.document.uri;if(r.scheme!=="file")return{result:void 0,message:`Resource of type '${r.scheme}' is not supported. Ensure cursor is in the editor.`};if(t=U.workspace.getWorkspaceFolder(r),!t)return{result:void 0,message:"This file is not part of a workspace folder."}}else t=U.workspace.workspaceFolders[0];return t?{result:t.uri.fsPath,message:""}:{result:void 0,message:V.NOT_A_VALID_REPO}}async function co(){let e=await uo();return e.result?await lo(e.result)?{message:"",isValid:!0,folder:e.result}:{message:V.NOT_A_VALID_REPO,isValid:!1}:{message:e.message||V.NOT_A_VALID_REPO,isValid:!1}}async function Yr(e){_.instance.logInfo(`Getting details from config file of '${(0,ao.basename)(e)}'`);let t=Dt(e),r=await t.getConfig("user.name","local"),s=await t.getConfig("user.email","local"),n=await t.getConfig("user.signingkey","local");return{userName:r.value||"",email:s.value||"",signingKey:n.value||""}}async function $t(e,t){let r=Dt(e);await r.addConfig("user.name",t.userName,!1,"local"),await r.addConfig("user.email",t.email,!1),await r.addConfig("user.signingkey",t.signingKey,!1,"local")}async function lo(e){try{return await Dt(e).checkIsRepo()}catch{return!1}}async function ce(e){return e.status===1?(U.window.showErrorMessage(e.message||"One of label, userName or email properties is missing in the config. Please verify."),await U.commands.executeCommand(b.GET_USER_PROFILE,"missing field in profile"),!1):e.status===2?(await U.window.showInformationMessage("No user profiles defined. Do you want to define one now?","Yes","No")==="Yes"&&await U.commands.executeCommand(b.CREATE_USER_PROFILE),!1):!0}async function ne(){let e=await uo();if(!e.result)return{status:4,message:e.message||V.NOT_A_VALID_REPO};let t=e.result;if(!await lo(t))return{status:4,message:V.NOT_A_VALID_REPO};let s=ae();await Pl(s);let n=s.filter(c=>c.selected===!0)||[],i=n.length>0?n[0]:void 0,a=await Yr(t);if(s.length===0)return _.instance.logInfo("No profiles found in settings."),{status:2,message:"No profiles found in settings.",profilesInVSConfigCount:0,selectedProfile:i,configInSync:!1,currentFolder:t};if(n.length===0)return _.instance.logInfo("No profiles selected in settings."),{status:3,message:"No profiles selected in settings.",profilesInVSConfigCount:s.length,selectedProfile:i,configInSync:!1,currentFolder:t};if(i&&(i.label===void 0||i.userName===void 0||i.email===void 0))return _.instance.logInfo("One of label, userName or email properties is missing in the config."),{status:1,message:"One of label, userName or email properties is missing in the config. Please verify.",profilesInVSConfigCount:s.length,selectedProfile:i,configInSync:!1,currentFolder:t};let o=s.find(c=>c.userName===a.userName&&c.email===a.email&&c.signingKey===a.signingKey),d=await U.workspace.getConfiguration("gitConfigUser").get("selectMatchedProfileAutomatically");if(_.instance.logInfo(`Select matched profile automatically: ${d}`),o&&d===!0&&i&&i.id!==o.id)return _.instance.logInfo(`Current git config matches '${o.label}'. Selecting it automatically.`),await U.workspace.getConfiguration("gitConfigUser").update("profiles",s.map(c=>({...c,selected:c.id===o.id})),!0),{status:5,message:"",profilesInVSConfigCount:s.length,selectedProfile:o,configInSync:!0,currentFolder:t};let p=ut(a,i);return p.result?{status:5,message:"",profilesInVSConfigCount:s.length,selectedProfile:i,configInSync:p.result,currentFolder:t}:{status:0,message:p.message||"Git config is not in sync with the selected profile.",profilesInVSConfigCount:s.length,selectedProfile:i,configInSync:p.result,currentFolder:t}}async function Pl(e){let t=!1;e.forEach(r=>{(r.id===void 0||r.id===""||r.signingKey==null||r.signingKey==null)&&(t=!0),r.id||(r.id=je()),r.signingKey||(r.signingKey="")}),t&&await U.workspace.getConfiguration("gitConfigUser").update("profiles",e,!0)}var Bt=class e{static{this.instance=null}static Instance(){return this.instance===null&&(this.instance=new e),this.instance}async execute(){try{let t=await ne();if(!await ce(t))return{};let s=(await Se()).result;return s&&(await fs(s),tt.commands.executeCommand(b.GET_USER_PROFILE,"deleted profile")),tt.window.showInformationMessage(`Profile '${s.label}' deleted.`),{result:!0}}catch(t){return _.instance.logError(`Error ocurred while deleting profile. ${t}`),tt.window.showErrorMessage("Error ocurred while deleting profile."),{result:!1}}}};var Ut=$(require("vscode"));var $e=class e{static{this.instance=null}static Instance(){return this.instance===null&&(this.instance=new e),this.instance}async execute(){try{let t=await ne();if(!await ce(t))return{};let s=(await Se()).result;if(s){s.detail=void 0,s.label=s.label;let i=await ms(s);i&&(i.id?await Y(i,i.id):await Y(i,i.label),Ut.commands.executeCommand(b.GET_USER_PROFILE,"edited profile"))}return{result:!0}}catch(t){return _.instance.logError(`Error ocurred while editing profile. ${t}`),Ut.window.showErrorMessage("Error ocurred while editing profile."),{result:!1}}}};var Gt=class{constructor(){}async execute(t){_.instance.logInfo(`Getting user profiles from settings [${t}]`);let r=await ne();return await ve.instance.updateStatus(r.selectedProfile,r.currentFolder,r.configInSync?"Normal":"Warning",r.message),{}}};var fo=require("path"),Ce=$(require("vscode"));var jt=class e{static{this.instance=null}static Instance(){return this.instance===null&&(this.instance=new e),this.instance}async execute(){try{let t=await ne();if(!await ce(t))return{};if(t.status===4)return Ce.window.showErrorMessage(t.message||V.NOT_A_VALID_REPO),await Ce.commands.executeCommand(b.GET_USER_PROFILE,"invalid workspace"),{};let r=t.currentFolder||".\\",n=(await Se()).result;return n?ce(t)?(n.detail=void 0,n.label=n.label,n.selected=!0,await Y(Object.assign({},n)),$t(r,n),await Ce.commands.executeCommand(b.GET_USER_PROFILE,"picked profile"),await Ce.window.showInformationMessage(`Profile '${n.label}' is now applied for '${(0,fo.basename)(r)}'. \u{1F389}`),{result:n}):{}:{result:void 0}}catch(t){return _.instance.logError(`Error ocurred while picking profile. ${t}`),Ce.window.showErrorMessage("Error ocurred while picking profile."),{result:void 0,error:t}}}};var Wt=require("path"),ee=$(require("vscode"));var Vt=class{async execute(){_.instance.logInfo("Click event on status bar icon");let t=await ne();if(!ce(t))return{};let r=t.currentFolder||".\\",s;if(t.status===3)s=await ee.window.showInformationMessage(`You have ${t.profilesInVSConfigCount} profile(s) in settings, but none are selected. What do you want to do?`,"Pick a profile","Edit existing","Create new");else{if(t.selectedProfile===void 0)return _.instance.logError("Selected profile is undefined"),{};let n=["Yes, apply","No, pick another","Edit existing","Create new"],i=["Pick a profile","Edit existing","Create new"],a=`'${(0,Wt.basename)(r)}' is not using user details from '${Pe(t.selectedProfile.label)}' profile. Do you want to apply the user details from profile '${Pe(t.selectedProfile.label)}'?`,o=`'${(0,Wt.basename)(r)}' is already using user details from the profile '${Pe(t.selectedProfile.label)}'. What do you want to do?`,d=t.configInSync?i:n,p=t.configInSync?o:a;s=await ee.window.showInformationMessage(p,...d)}return s===void 0?(await ee.commands.executeCommand(b.GET_USER_PROFILE,"user cancelled prompt"),{}):s==="Edit existing"?(await $e.Instance().execute(),await ee.commands.executeCommand(b.GET_USER_PROFILE,"edit profile"),{}):s==="Yes, apply"||s==="Apply again"?($t(r,t.selectedProfile),await ee.commands.executeCommand(b.GET_USER_PROFILE,"applied profile"),await ee.window.showInformationMessage(`Profile '${t.selectedProfile.label}' is now applied for '${(0,Wt.basename)(r)}'. \u{1F389}`),{}):s==="Create new"?(await ee.commands.executeCommand(b.CREATE_USER_PROFILE),await ee.commands.executeCommand(b.GET_USER_PROFILE,"created new profile"),{}):((s==="No, pick another"||s==="Pick a profile")&&await ee.commands.executeCommand(b.PICK_USER_PROFILE),{})}};var Hr=require("path"),Be=require("vscode");var Kt=class{constructor(t=!0){this.onStartup=!0;this.onStartup=t}async execute(){let t=await co();if(!(t.isValid&&t.folder))return{result:!0};let r=await Yr(t.folder),s=ae();if(ls(r))return s.length==0?await Be.window.showInformationMessage(`No user details found in git config of '${(0,Hr.basename)(t.folder)}'. Do you want to create a new user detail profile now?`,"Yes","No")=="Yes"?(await await Be.commands.executeCommand(b.CREATE_USER_PROFILE),{result:!0}):{result:!0}:await Be.window.showInformationMessage(`No user details found in git config of '${(0,Hr.basename)(t.folder)}'. Do you want to apply a user profile now?`,"Yes","No")=="Yes"?(await Be.commands.executeCommand(b.CREATE_USER_PROFILE),{result:!0}):{result:!0};await Promise.all(s.filter(i=>i.selected).map(async i=>{i.selected=!1,await Y(i,i.id)}));let n=s.filter(i=>ut(i,r));if(n.length>=1)n[0].selected=!0,n[0].id?await Y(n[0],n[0].id):await Y(n[0],n[0].label);else{let i=new Ee(Pe(r.userName),r.userName,r.email,!0,`${r.userName} (${r.email}) `);await Y(i)}return{result:!0}}};var qt=new Map;async function Il(e){try{_.instance.logInfo("Activating extension"),Ol(e),Rl(e),xl(),_.instance.logInfo("Initializing commands complete.")}catch(t){_.instance.logError("Error ocurred",t)}}function Rl(e){_.instance.logInfo("Initializing commands"),e.subscriptions.push(P.commands.registerCommand(b.STATUS_BAR_CLICK,new Vt().execute)),e.subscriptions.push(ve.instance.StatusBar),e.subscriptions.push(P.commands.registerCommand(b.CREATE_USER_PROFILE,new ft().execute)),e.subscriptions.push(P.commands.registerCommand(b.SYNC_VSC_PROFILES_WITH_GIT_CONFIG,new Kt().execute)),e.subscriptions.push(P.commands.registerCommand(b.EDIT_USER_PROFILE,new $e().execute)),e.subscriptions.push(P.commands.registerCommand(b.GET_USER_PROFILE,new Gt().execute)),e.subscriptions.push(P.commands.registerCommand(b.DELETE_USER_PROFILE,new Bt().execute)),e.subscriptions.push(P.commands.registerCommand(b.PICK_USER_PROFILE,new jt().execute)),ve.instance.attachCommand(b.STATUS_BAR_CLICK)}function Ol(e){_.instance.logInfo("Registering for vs settings change event"),e.subscriptions.push(P.workspace.onDidChangeConfiguration(async()=>await P.commands.executeCommand(b.GET_USER_PROFILE,"changed settings"))),e.subscriptions.push(P.window.onDidChangeActiveTextEditor(async()=>await P.commands.executeCommand(b.GET_USER_PROFILE,"changed active editor"))),e.subscriptions.push(P.workspace.onDidChangeWorkspaceFolders(async()=>await P.commands.executeCommand(b.GET_USER_PROFILE,"changed workspace folders"))),e.subscriptions.push(P.workspace.onDidOpenTextDocument(async()=>await P.commands.executeCommand(b.GET_USER_PROFILE,"opened text document"))),e.subscriptions.push(P.workspace.onDidCloseTextDocument(async()=>await P.commands.executeCommand(b.GET_USER_PROFILE,"closed text document")))}function xl(){qt.clear();let e=P.workspace.createFileSystemWatcher("**/.git/config");e.onDidChange(async()=>{await P.commands.executeCommand(b.GET_USER_PROFILE,"changed git config")}),e.onDidCreate(async()=>{await P.commands.executeCommand(b.GET_USER_PROFILE,"created git config")}),e.onDidDelete(async()=>{await P.commands.executeCommand(b.GET_USER_PROFILE,"deleted git config")}),qt.set("**/.git/config",e),_.instance.logInfo("File watcher created for git config")}function Al(){for(let e of qt.values())e.dispose();qt.clear()}0&&(module.exports={activate,deactivate});
