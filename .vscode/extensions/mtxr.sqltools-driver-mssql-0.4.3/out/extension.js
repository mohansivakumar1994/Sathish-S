var l=Object.defineProperty,f=Object.defineProperties,P=Object.getOwnPropertyDescriptor,S=Object.getOwnPropertyDescriptors,E=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols;var m=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable;var p=(r,e,o)=>e in r?l(r,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[e]=o,v=(r,e)=>{for(var o in e||(e={}))m.call(e,o)&&p(r,o,e[o]);if(d)for(var o of d(e))b.call(e,o)&&p(r,o,e[o]);return r},g=(r,e)=>f(r,S(e));var k=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),A=(r,e)=>{for(var o in e)l(r,o,{get:e[o],enumerable:!0})},q=(r,e,o,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of E(e))!m.call(r,i)&&i!==o&&l(r,i,{get:()=>e[i],enumerable:!(n=P(e,i))||n.enumerable});return r};var x=r=>q(l({},"__esModule",{value:!0}),r);var h=k((j,D)=>{D.exports={name:"sqltools-driver-mssql",displayName:"SQLTools Microsoft SQL Server/Azure",description:"SQLTools Microsoft SQL Server/Azure",version:"0.4.3",engines:{vscode:"^1.72.0"},publisher:"mtxr",license:"MIT",private:!0,repository:{type:"git",url:"https://github.com/mtxr/vscode-sqltools.git",directory:"packages/drivers.mssql"},bugs:{url:"https://github.com/mtxr/vscode-sqltools/labels/mssql"},keywords:["sqltools-driver","mssql","sqlserver","azure"],galleryBanner:{theme:"light",color:"#ffffff"},icon:"icon.png",categories:["Programming Languages","Snippets","Formatters","Other"],extensionDependencies:["mtxr.sqltools"],activationEvents:["*","onLanguage:sql","onCommand:sqltools.*"],main:"./out/extension.js",scripts:{"test:tsc":"tsc --noEmit -p ./tsconfig.json --skipLibCheck",clean:"rimraf -rf out dist *.vsix",predev:"yarn run clean",dev:"yarn run watch",prebuild:"yarn run clean && yarn run tsc-check",build:'cross-env NODE_ENV=production concurrently "npm:build:*"',"build:ext":`yarn run compile:ext --define:process.env.NODE_ENV="'production'" --minify`,"build:ls":`yarn run compile:ls --define:process.env.NODE_ENV="'production'" --minify`,esbuild:"esbuild --platform=node --tsconfig=./tsconfig.json --external:vscode --color=true --format=cjs",prepackage:"yarn run build",package:"vsce package --yarn -o .","compile:ext":`yarn run esbuild --bundle ./src/extension.ts --outfile=./out/extension.js --target=es2017 --define:process.env.PRODUCT="'ext'"`,"compile:ls":`yarn run esbuild --bundle ./src/ls/plugin.ts --outfile=./out/ls/plugin.js --target=es2015 --define:process.env.PRODUCT="'ls'"`,"tsc-check":"yarn run ts --noEmit --preserveWatchOutput",watch:'concurrently "npm:watch:*"',"watch:ext":`yarn run compile:ext --define:process.env.NODE_ENV="'development'" --sourcemap --watch`,"watch:ls":`yarn run compile:ls --define:process.env.NODE_ENV="'development'" --sourcemap --watch`,"dev:tsc":"yarn run tsc-check -w",ts:"tsc -p ."},devDependencies:{"@sqltools/base-driver":"latest","@sqltools/types":"^0.1.7","@types/lodash":"^4.14.123","@types/mssql":"^4.0.12","@types/vscode":"^1.72.0",concurrently:"^5.2.0",esbuild:"^0.15.7",lodash:"^4.17.19",mssql:"^5.0.5",rimraf:"^3.0.2",typescript:"~4.8.3","@vscode/vsce":"^2.19.0"}}});var C={};A(C,{activate:()=>M,deactivate:()=>T});module.exports=x(C);var c=require("vscode");var u=[{displayName:"SQL Server/Azure",value:"MSSQL"}];var w="sqltools-driver-credentials",{publisher:L,name:N}=h(),y="SQL Server/Azure";async function M(r){let e=c.extensions.getExtension("mtxr.sqltools");if(!e)throw new Error("SQLTools not installed");await e.activate();let o=e.exports,n=`${L}.${N}`,i={extensionId:n,name:`${y} Plugin`,type:"driver",async register(s){s.resourcesMap().set(`driver/${u[0].value}/icons`,{active:r.asAbsolutePath("icons/active.png"),default:r.asAbsolutePath("icons/default.png"),inactive:r.asAbsolutePath("icons/inactive.png")}),u.forEach(({value:t})=>{s.resourcesMap().set(`driver/${t}/extension-id`,n),s.resourcesMap().set(`driver/${t}/connection-schema`,r.asAbsolutePath("connection.schema.json")),s.resourcesMap().set(`driver/${t}/ui-schema`,r.asAbsolutePath("ui.schema.json"))}),await s.client.sendRequest("ls/RegisterPlugin",{path:r.asAbsolutePath("out/ls/plugin.js")})}};return o.registerPlugin(i),{driverName:y,parseBeforeSaveConnection:({connInfo:s})=>{let t=["connectionMethod","id","usePassword"];return s.usePassword&&(s.usePassword.toString().toLowerCase().includes("ask")?t.push("password"):s.usePassword.toString().toLowerCase().includes("empty")?(s.password="",t.push("askForPassword")):s.usePassword.toString().toLowerCase().includes("save")?t.push("askForPassword"):s.usePassword.toString().toLowerCase().includes("secure")&&(t.push("password"),t.push("askForPassword"))),s.connectString&&(t.push("port"),t.push("askForPassword")),t.forEach(a=>delete s[a]),s},parseBeforeEditConnection:({connInfo:s})=>{let t=g(v({},s),{connectionMethod:"Server and Port"});return s.socketPath?t.connectionMethod="Socket File":s.connectString&&(t.connectionMethod="Connection String"),s.askForPassword?(t.usePassword="Ask on connect",delete t.password):typeof s.password=="string"?(delete t.askForPassword,t.usePassword=s.password?"Save password":"Use empty password"):t.usePassword="SQLTools Driver Credentials",t},resolveConnection:async({connInfo:s})=>{if(s.password===void 0&&!s.askForPassword&&!s.connectString){let t=[s.name,s.username||""],a=await c.authentication.getSession(w,t,{silent:!0});a||(a=await c.authentication.getSession(w,t,{createIfNone:!0})),a&&(s.password=a.accessToken)}return s},driverAliases:u}}function T(){}0&&(module.exports={activate,deactivate});
